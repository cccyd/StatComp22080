<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="22080" />


<title>Homework</title>

<script src="data:application/javascript;base64,Ly8gUGFuZG9jIDIuOSBhZGRzIGF0dHJpYnV0ZXMgb24gYm90aCBoZWFkZXIgYW5kIGRpdi4gV2UgcmVtb3ZlIHRoZSBmb3JtZXIgKHRvCi8vIGJlIGNvbXBhdGlibGUgd2l0aCB0aGUgYmVoYXZpb3Igb2YgUGFuZG9jIDwgMi44KS4KZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignRE9NQ29udGVudExvYWRlZCcsIGZ1bmN0aW9uKGUpIHsKICB2YXIgaHMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCJkaXYuc2VjdGlvbltjbGFzcyo9J2xldmVsJ10gPiA6Zmlyc3QtY2hpbGQiKTsKICB2YXIgaSwgaCwgYTsKICBmb3IgKGkgPSAwOyBpIDwgaHMubGVuZ3RoOyBpKyspIHsKICAgIGggPSBoc1tpXTsKICAgIGlmICghL15oWzEtNl0kL2kudGVzdChoLnRhZ05hbWUpKSBjb250aW51ZTsgIC8vIGl0IHNob3VsZCBiZSBhIGhlYWRlciBoMS1oNgogICAgYSA9IGguYXR0cmlidXRlczsKICAgIHdoaWxlIChhLmxlbmd0aCA+IDApIGgucmVtb3ZlQXR0cmlidXRlKGFbMF0ubmFtZSk7CiAgfQp9KTsK"></script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>



<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<link rel="stylesheet" href="data:text/css,body%20%7B%0Abackground%2Dcolor%3A%20%23fff%3B%0Amargin%3A%201em%20auto%3B%0Amax%2Dwidth%3A%20700px%3B%0Aoverflow%3A%20visible%3B%0Apadding%2Dleft%3A%202em%3B%0Apadding%2Dright%3A%202em%3B%0Afont%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0Afont%2Dsize%3A%2014px%3B%0Aline%2Dheight%3A%201%2E35%3B%0A%7D%0A%23TOC%20%7B%0Aclear%3A%20both%3B%0Amargin%3A%200%200%2010px%2010px%3B%0Apadding%3A%204px%3B%0Awidth%3A%20400px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Aborder%2Dradius%3A%205px%3B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Afont%2Dsize%3A%2013px%3B%0Aline%2Dheight%3A%201%2E3%3B%0A%7D%0A%23TOC%20%2Etoctitle%20%7B%0Afont%2Dweight%3A%20bold%3B%0Afont%2Dsize%3A%2015px%3B%0Amargin%2Dleft%3A%205px%3B%0A%7D%0A%23TOC%20ul%20%7B%0Apadding%2Dleft%3A%2040px%3B%0Amargin%2Dleft%3A%20%2D1%2E5em%3B%0Amargin%2Dtop%3A%205px%3B%0Amargin%2Dbottom%3A%205px%3B%0A%7D%0A%23TOC%20ul%20ul%20%7B%0Amargin%2Dleft%3A%20%2D2em%3B%0A%7D%0A%23TOC%20li%20%7B%0Aline%2Dheight%3A%2016px%3B%0A%7D%0Atable%20%7B%0Amargin%3A%201em%20auto%3B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dcolor%3A%20%23DDDDDD%3B%0Aborder%2Dstyle%3A%20outset%3B%0Aborder%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0Aborder%2Dwidth%3A%202px%3B%0Apadding%3A%205px%3B%0Aborder%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dstyle%3A%20inset%3B%0Aline%2Dheight%3A%2018px%3B%0Apadding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0Aborder%2Dleft%2Dstyle%3A%20none%3B%0Aborder%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Ap%20%7B%0Amargin%3A%200%2E5em%200%3B%0A%7D%0Ablockquote%20%7B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Apadding%3A%200%2E25em%200%2E75em%3B%0A%7D%0Ahr%20%7B%0Aborder%2Dstyle%3A%20solid%3B%0Aborder%3A%20none%3B%0Aborder%2Dtop%3A%201px%20solid%20%23777%3B%0Amargin%3A%2028px%200%3B%0A%7D%0Adl%20%7B%0Amargin%2Dleft%3A%200%3B%0A%7D%0Adl%20dd%20%7B%0Amargin%2Dbottom%3A%2013px%3B%0Amargin%2Dleft%3A%2013px%3B%0A%7D%0Adl%20dt%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Aul%20%7B%0Amargin%2Dtop%3A%200%3B%0A%7D%0Aul%20li%20%7B%0Alist%2Dstyle%3A%20circle%20outside%3B%0A%7D%0Aul%20ul%20%7B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Apre%2C%20code%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0Aborder%2Dradius%3A%203px%3B%0Acolor%3A%20%23333%3B%0Awhite%2Dspace%3A%20pre%2Dwrap%3B%20%0A%7D%0Apre%20%7B%0Aborder%2Dradius%3A%203px%3B%0Amargin%3A%205px%200px%2010px%200px%3B%0Apadding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Acode%20%7B%0Afont%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0Afont%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0Apadding%3A%202px%200px%3B%0A%7D%0Adiv%2Efigure%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0Abackground%2Dcolor%3A%20%23FFFFFF%3B%0Apadding%3A%202px%3B%0Aborder%3A%201px%20solid%20%23DDDDDD%3B%0Aborder%2Dradius%3A%203px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Amargin%3A%200%205px%3B%0A%7D%0Ah1%20%7B%0Amargin%2Dtop%3A%200%3B%0Afont%2Dsize%3A%2035px%3B%0Aline%2Dheight%3A%2040px%3B%0A%7D%0Ah2%20%7B%0Aborder%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Apadding%2Dbottom%3A%202px%3B%0Afont%2Dsize%3A%20145%25%3B%0A%7D%0Ah3%20%7B%0Aborder%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Afont%2Dsize%3A%20120%25%3B%0A%7D%0Ah4%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0Amargin%2Dleft%3A%208px%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Ah5%2C%20h6%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23ccc%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Aa%20%7B%0Acolor%3A%20%230033dd%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Aa%3Ahover%20%7B%0Acolor%3A%20%236666ff%3B%20%7D%0Aa%3Avisited%20%7B%0Acolor%3A%20%23800080%3B%20%7D%0Aa%3Avisited%3Ahover%20%7B%0Acolor%3A%20%23BB00BB%3B%20%7D%0Aa%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0Aa%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%0A" type="text/css" />




</head>

<body>




<h1 class="title toc-ignore">Homework</h1>
<h4 class="author">22080</h4>
<h4 class="date">2022/11/16</h4>



<div id="section" class="section level1">
<h1>2022-09-09</h1>
<div id="question" class="section level2">
<h2>Question</h2>
<p>Use knitr to produce at least 3 examples (texts, figures, tables).</p>
</div>
<div id="answer" class="section level2">
<h2>Answer</h2>
<div id="texts" class="section level3">
<h3>1. Texts</h3>
<p><strong>Lindeberg’s CLT</strong></p>
<p>Let <span class="math inline">\(\{X_{nj},j=1,...,k_n\}\)</span> be independent random variables with <span class="math inline">\(0&lt;\sigma^2_n=Var(\sum_{j=1}^{k_n}X_{nj})&lt; \infty, n=1,2,...,\)</span> and <span class="math inline">\(k_n \rightarrow \infty\)</span> as <span class="math inline">\(n \rightarrow \infty\)</span>.</p>
<p>If <span class="math inline">\(\sum_{j=1}^{k_n}E[(X_{nj}-EX_{nj})^2I_{\{|X_{nj}-EX_{nj}|&gt;\epsilon\sigma_n\}}]=o(\sigma^2_n)\)</span> for any <span class="math inline">\(\epsilon&gt;0\)</span>, then <span class="math display">\[\frac{1}{\sigma_n}\sum_{j=1}^{k_n}(X_{nj}-EX_{nj})\stackrel{d}\longrightarrow N(0,1).\]</span></p>
</div>
<div id="figures" class="section level3">
<h3>2. Figures</h3>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">100</span>, <span class="dv">0</span>, <span class="dv">4</span>)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> x<span class="sc">^</span><span class="dv">3</span> <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x,y)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="tables" class="section level3">
<h3>3. Tables</h3>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>dataset <span class="ot">&lt;-</span> iris</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(dataset)</span></code></pre></div>
<pre><code>##   Sepal.Length Sepal.Width Petal.Length Petal.Width Species
## 1          5.1         3.5          1.4         0.2  setosa
## 2          4.9         3.0          1.4         0.2  setosa
## 3          4.7         3.2          1.3         0.2  setosa
## 4          4.6         3.1          1.5         0.2  setosa
## 5          5.0         3.6          1.4         0.2  setosa
## 6          5.4         3.9          1.7         0.4  setosa</code></pre>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="fu">head</span>(dataset))</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="right">Sepal.Length</th>
<th align="right">Sepal.Width</th>
<th align="right">Petal.Length</th>
<th align="right">Petal.Width</th>
<th align="left">Species</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">5.1</td>
<td align="right">3.5</td>
<td align="right">1.4</td>
<td align="right">0.2</td>
<td align="left">setosa</td>
</tr>
<tr class="even">
<td align="right">4.9</td>
<td align="right">3.0</td>
<td align="right">1.4</td>
<td align="right">0.2</td>
<td align="left">setosa</td>
</tr>
<tr class="odd">
<td align="right">4.7</td>
<td align="right">3.2</td>
<td align="right">1.3</td>
<td align="right">0.2</td>
<td align="left">setosa</td>
</tr>
<tr class="even">
<td align="right">4.6</td>
<td align="right">3.1</td>
<td align="right">1.5</td>
<td align="right">0.2</td>
<td align="left">setosa</td>
</tr>
<tr class="odd">
<td align="right">5.0</td>
<td align="right">3.6</td>
<td align="right">1.4</td>
<td align="right">0.2</td>
<td align="left">setosa</td>
</tr>
<tr class="even">
<td align="right">5.4</td>
<td align="right">3.9</td>
<td align="right">1.7</td>
<td align="right">0.4</td>
<td align="left">setosa</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div id="section-1" class="section level1">
<h1>2022-09-15</h1>
<div id="question-1" class="section level2">
<h2>Question</h2>
<p>Exercises 3.3, 3.7, 3.12, 3.13(pages 94-96, Statistical Computating with R)</p>
</div>
<div id="answer-1" class="section level2">
<h2>Answer</h2>
<div id="section-2" class="section level3">
<h3>3.4</h3>
<div id="use-the-inverse-transform-method-to-simulate-a-random-sample-from-the-pareto2-2." class="section level4">
<h4>(1) Use the inverse transform method to simulate a random sample from the Pareto(2, 2).</h4>
<p>Firstly, we need to generate the random numbers that follow a random distribution. Then we derive the probability inverse transformation to get the random numbers that follow Pareto(2, 2).</p>
<p>Since <span class="math inline">\(F(x)=1-(\frac{b}{x})^a, \quad x\geq b&gt;0,a&gt;0\)</span>, we can get <span class="math inline">\(x=F^{-1}(u)=b\cdot (1-u)^{-\frac{1}{a}}, u \sim U(0,1)\)</span></p>
</div>
<div id="graph-the-density-histogram-of-the-sample-with-the-pareto2-2-density" class="section level4">
<h4>(2) Graph the density histogram of the sample with the Pareto(2, 2) density</h4>
<p>It’s easy to know that when <span class="math inline">\(x&lt;b\)</span> the density of x is 0, otherwise the density of <span class="math inline">\(x\)</span> is <span class="math inline">\(\frac{dF(x)}{dx}=a\cdot b^a\cdot x^{-a-1}\)</span>.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>rpareto <span class="ot">=</span> <span class="cf">function</span>(num, a, b){</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stopifnot</span>(a <span class="sc">&gt;</span> <span class="dv">0</span> <span class="sc">&amp;&amp;</span> b <span class="sc">&gt;</span> <span class="dv">0</span>)</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>  u <span class="ot">=</span> <span class="fu">runif</span>(num)</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(b<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>u)<span class="sc">^</span>(<span class="sc">-</span><span class="dv">1</span><span class="sc">/</span>a))</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>dpareto <span class="ot">=</span> <span class="cf">function</span>(x, a, b){</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stopifnot</span>(a <span class="sc">&gt;</span> <span class="dv">0</span> <span class="sc">&amp;&amp;</span> b <span class="sc">&gt;</span> <span class="dv">0</span>)</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sapply</span>(x, <span class="cf">function</span>(u) <span class="cf">if</span> (u<span class="sc">&lt;</span>b) {<span class="dv">0</span>} <span class="cf">else</span> {a<span class="sc">*</span>b<span class="sc">^</span>a<span class="sc">*</span>u<span class="sc">^</span>(<span class="sc">-</span>a<span class="dv">-1</span>)})</span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a>sample <span class="ot">=</span> <span class="fu">rpareto</span>(N, a, b)</span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(sample, <span class="at">probability =</span> <span class="cn">TRUE</span>)</span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a>ran <span class="ot">=</span> <span class="fu">range</span>(sample)</span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a>x <span class="ot">=</span> <span class="fu">seq</span>(ran[<span class="dv">1</span>], ran[<span class="dv">2</span>], <span class="fl">0.01</span>)</span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a>y <span class="ot">=</span> <span class="fu">dpareto</span>(x, a, b)</span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="at">x=</span>x, <span class="at">y=</span>y)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
</div>
<div id="section-3" class="section level3">
<h3>3.7</h3>
<p>As for Acceptance-rejection algorithm, we consider <span class="math inline">\(g(\cdot)\)</span> to be the density of Uniform distribution. So we generate random number <span class="math inline">\(U \sim U(0,1)\)</span> and <span class="math inline">\(Y \sim U(0,1)\)</span>, if <span class="math inline">\(U \le f(Y)\)</span>, then accept Y and return X = Y.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>rbeta <span class="ot">=</span> <span class="cf">function</span>(num, df, dgen, rgen, c){</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>  ct <span class="ot">=</span> <span class="dv">1</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>  n <span class="ot">=</span> <span class="dv">1</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>  res <span class="ot">=</span> <span class="fu">numeric</span>(num)</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>  <span class="cf">while</span>(n <span class="sc">&lt;=</span> num) {</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>    y <span class="ot">=</span> <span class="fu">rgen</span>(<span class="dv">1</span>)</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>    u <span class="ot">=</span> <span class="fu">runif</span>(<span class="dv">1</span>)</span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (u <span class="sc">&lt;</span> <span class="fu">df</span>(y)<span class="sc">/</span><span class="fu">dgen</span>(y)<span class="sc">/</span>c) {</span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>      res[n] <span class="ot">=</span> y</span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>      n <span class="ot">=</span> n <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>    ct <span class="ot">=</span> ct <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">&quot;Acceptance rate: &quot;</span>,(n<span class="dv">-1</span>)<span class="sc">/</span>(ct<span class="dv">-1</span>)))</span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(res)</span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a>rgen <span class="ot">=</span> <span class="cf">function</span>(size){</span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">runif</span>(size, <span class="at">min =</span> u.min, <span class="at">max =</span> u.max)</span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb6-21"><a href="#cb6-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-22"><a href="#cb6-22" aria-hidden="true" tabindex="-1"></a>dgen <span class="ot">=</span> <span class="cf">function</span>(x){</span>
<span id="cb6-23"><a href="#cb6-23" aria-hidden="true" tabindex="-1"></a>    <span class="fu">dunif</span>(x, <span class="at">min =</span> u.min, <span class="at">max =</span> u.max)</span>
<span id="cb6-24"><a href="#cb6-24" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb6-25"><a href="#cb6-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-26"><a href="#cb6-26" aria-hidden="true" tabindex="-1"></a>df <span class="ot">=</span> <span class="cf">function</span>(x){</span>
<span id="cb6-27"><a href="#cb6-27" aria-hidden="true" tabindex="-1"></a>    <span class="fu">dbeta</span>(<span class="at">x =</span> x, <span class="at">shape1 =</span> a, <span class="at">shape2 =</span> b)</span>
<span id="cb6-28"><a href="#cb6-28" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb6-29"><a href="#cb6-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-30"><a href="#cb6-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-31"><a href="#cb6-31" aria-hidden="true" tabindex="-1"></a>a <span class="ot">=</span> <span class="dv">3</span></span>
<span id="cb6-32"><a href="#cb6-32" aria-hidden="true" tabindex="-1"></a>b <span class="ot">=</span> <span class="dv">2</span></span>
<span id="cb6-33"><a href="#cb6-33" aria-hidden="true" tabindex="-1"></a>N <span class="ot">=</span> <span class="dv">10000</span></span>
<span id="cb6-34"><a href="#cb6-34" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb6-35"><a href="#cb6-35" aria-hidden="true" tabindex="-1"></a>xs <span class="ot">=</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="fl">0.01</span>)</span>
<span id="cb6-36"><a href="#cb6-36" aria-hidden="true" tabindex="-1"></a>u.max <span class="ot">=</span> <span class="fu">max</span>(xs)</span>
<span id="cb6-37"><a href="#cb6-37" aria-hidden="true" tabindex="-1"></a>u.min <span class="ot">=</span> <span class="fu">min</span>(xs)</span>
<span id="cb6-38"><a href="#cb6-38" aria-hidden="true" tabindex="-1"></a>y.max <span class="ot">=</span> <span class="fu">max</span>(<span class="fu">df</span>(xs))</span>
<span id="cb6-39"><a href="#cb6-39" aria-hidden="true" tabindex="-1"></a>c <span class="ot">=</span> y.max <span class="sc">/</span> (u.max <span class="sc">-</span> u.min)</span>
<span id="cb6-40"><a href="#cb6-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-41"><a href="#cb6-41" aria-hidden="true" tabindex="-1"></a>sample <span class="ot">=</span> <span class="fu">rbeta</span>(<span class="at">num =</span> N, <span class="at">df =</span> df, <span class="at">rgen =</span> rgen, <span class="at">dgen =</span> dgen, c)  </span></code></pre></div>
<pre><code>## [1] &quot;Acceptance rate: 0.564907920009039&quot;</code></pre>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>ys <span class="ot">=</span> <span class="fu">df</span>(xs)</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>nrBins <span class="ot">=</span> <span class="dv">50</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute the maximum value in the histogram for a better visualization.</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>bins <span class="ot">=</span> <span class="fu">seq</span>(<span class="fu">min</span>(xs), <span class="fu">max</span>(xs), <span class="at">by =</span> <span class="fu">dist</span>(<span class="fu">range</span>(xs))<span class="sc">/</span>nrBins)</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>hist.vals <span class="ot">=</span> <span class="fu">table</span>(<span class="fu">cut</span>(<span class="at">x =</span> sample, bins))</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a><span class="co"># adapt to a total area of 1 (probability histogram).</span></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>hist.vals <span class="ot">=</span> hist.vals<span class="sc">/</span><span class="fu">sum</span>(hist.vals) <span class="sc">*</span> nrBins</span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a><span class="co"># y limits as maximum of distribution and sample.</span></span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>ylim <span class="ot">=</span> <span class="fu">c</span>(<span class="fu">min</span>(<span class="fu">c</span>(ys, hist.vals)), <span class="fu">max</span>(<span class="fu">c</span>(ys, hist.vals)))</span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(sample, <span class="at">probability =</span> <span class="cn">TRUE</span>, <span class="at">ylim =</span> ylim, <span class="at">breaks =</span> nrBins)</span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="at">x =</span> xs, <span class="at">y =</span> ys)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="section-4" class="section level3">
<h3>3.12</h3>
<p>According to the question, we first generate <span class="math inline">\(\Lambda\)</span> from <span class="math inline">\(Gamma(4, 2)\)</span>, and then generate 1000 sample from <span class="math inline">\(Exp(\Lambda)\)</span></p>
</div>
<div id="section-5" class="section level3">
<h3>3.13</h3>
<p>It’s obvious that we just need to compare the samples generated in 3.12 with the samples follow theoretical distributions. So we write down the answer of 3.12 and 3.13 together.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>N <span class="ot">=</span> <span class="dv">1000</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>r <span class="ot">=</span> <span class="dv">4</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>beta <span class="ot">=</span> <span class="dv">2</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>rmix <span class="ot">=</span> <span class="cf">function</span>(size, r, beta){</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rexp</span>(<span class="at">n =</span> N, <span class="fu">rgamma</span>(<span class="at">n =</span> N, r, beta))</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>sample <span class="ot">=</span> <span class="fu">rmix</span>(<span class="at">size =</span> size, <span class="at">r =</span> r, <span class="at">beta =</span> beta)</span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span> (sample, <span class="at">probability =</span> <span class="cn">TRUE</span>, <span class="at">breaks =</span> <span class="dv">100</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">2</span>))</span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a>dpareto <span class="ot">=</span> <span class="cf">function</span>(x, a, b){</span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stopifnot</span>(a <span class="sc">&gt;</span> <span class="dv">0</span> <span class="sc">&amp;&amp;</span> b <span class="sc">&gt;</span> <span class="dv">0</span>)</span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sapply</span>(x, <span class="cf">function</span>(u) {a<span class="sc">*</span>b<span class="sc">^</span>a<span class="sc">*</span>(b<span class="sc">+</span>u)<span class="sc">^</span>(<span class="sc">-</span>a<span class="dv">-1</span>)})</span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a>xs <span class="ot">=</span> <span class="fu">seq</span>(<span class="fu">min</span>(sample), <span class="fu">max</span>(sample), <span class="fl">0.01</span>)</span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="at">x =</span> xs, <span class="at">y =</span> <span class="fu">dpareto</span>(xs, <span class="at">a =</span> r, <span class="at">b =</span> beta))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
</div>
</div>
<div id="section-6" class="section level1">
<h1>2022-09-23</h1>
<div id="question-2" class="section level2">
<h2>Question</h2>
<ol style="list-style-type: decimal">
<li><p>Apply the fast sorting algorithm and analyse the computation time</p></li>
<li><p>Exercises 5.6, 5.7(pages 149-161, Statistical Computating with R)</p></li>
</ol>
</div>
<div id="answer-2" class="section level2">
<h2>Answer</h2>
<div id="section-7" class="section level3">
<h3>1.</h3>
<div id="for-n1042times1044times1046times1048times104-apply-the-fast-sorting-algorithm-to-randomly-permuted-numbers-of-1n." class="section level4">
<h4>(1) For <span class="math inline">\(n=10^4,2\times10^4,4\times10^4,6\times10^4,8\times10^4\)</span>, apply the fast sorting algorithm to randomly permuted numbers of 1,…,n.</h4>
<p>Firstly, we need to randomly pick one number(without loss of generality I always pick the first number) and divide the numbers into two groups by whether the number is larger to the selected number. And then we apply the same operation to these two groups until the series are placed in an increasing order.</p>
</div>
<div id="calculate-computation-time-averaged-over-100-simulations-denoted-by-an." class="section level4">
<h4>(2) Calculate computation time averaged over 100 simulations, denoted by an.</h4>
<p>It’s very obvious that we need to repeat the operations in (1) for 100 times and then calculate the averaged time.</p>
</div>
<div id="regress-a_n-on-t_nnlogn-and-graphically-show-the-results" class="section level4">
<h4>(3) Regress <span class="math inline">\(a_n\)</span> on <span class="math inline">\(t_n:=nlog(n)\)</span> and graphically show the results</h4>
<p>As for this question we need to regress <span class="math inline">\(a_n\)</span> on <span class="math inline">\(t_n\)</span> and then show the visualization result.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>quick_sort<span class="ot">&lt;-</span><span class="cf">function</span>(x){</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>  num<span class="ot">&lt;-</span><span class="fu">length</span>(x)</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(num<span class="sc">==</span><span class="dv">0</span><span class="sc">||</span>num<span class="sc">==</span><span class="dv">1</span>){<span class="fu">return</span>(x)</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>  }<span class="cf">else</span>{</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>    a<span class="ot">&lt;-</span>x[<span class="dv">1</span>]</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>    y<span class="ot">&lt;-</span>x[<span class="sc">-</span><span class="dv">1</span>]</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>    lower<span class="ot">&lt;-</span>y[y<span class="sc">&lt;</span>a]</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>    upper<span class="ot">&lt;-</span>y[y<span class="sc">&gt;=</span>a]</span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">c</span>(<span class="fu">quick_sort</span>(lower),a,<span class="fu">quick_sort</span>(upper)))}</span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">10</span><span class="sc">^</span><span class="dv">4</span>, <span class="dv">2</span><span class="sc">*</span><span class="dv">10</span><span class="sc">^</span><span class="dv">4</span>, <span class="dv">4</span><span class="sc">*</span><span class="dv">10</span><span class="sc">^</span><span class="dv">4</span>, <span class="dv">6</span><span class="sc">*</span><span class="dv">10</span><span class="sc">^</span><span class="dv">4</span>, <span class="dv">8</span><span class="sc">*</span><span class="dv">10</span><span class="sc">^</span><span class="dv">4</span>)</span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a>time <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">rep</span>(<span class="dv">0</span>,<span class="dv">500</span>), <span class="at">nrow =</span> <span class="dv">100</span>)</span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(n)) {</span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a>  num <span class="ot">&lt;-</span> n[j]</span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>) {</span>
<span id="cb10-18"><a href="#cb10-18" aria-hidden="true" tabindex="-1"></a>    data <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span>num)</span>
<span id="cb10-19"><a href="#cb10-19" aria-hidden="true" tabindex="-1"></a>    time_start<span class="ot">&lt;-</span><span class="fu">Sys.time</span>()</span>
<span id="cb10-20"><a href="#cb10-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">quick_sort</span>(data)</span>
<span id="cb10-21"><a href="#cb10-21" aria-hidden="true" tabindex="-1"></a>    exc_time<span class="ot">&lt;-</span><span class="fu">difftime</span>(<span class="fu">Sys.time</span>(),time_start,<span class="at">units =</span> <span class="st">&#39;mins&#39;</span>)</span>
<span id="cb10-22"><a href="#cb10-22" aria-hidden="true" tabindex="-1"></a>    time[i,j] <span class="ot">&lt;-</span> exc_time</span>
<span id="cb10-23"><a href="#cb10-23" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb10-24"><a href="#cb10-24" aria-hidden="true" tabindex="-1"></a>  <span class="co"># print(paste0(num,&#39; running time：&#39;,round(exc_time,2),&#39;mins&#39;))</span></span>
<span id="cb10-25"><a href="#cb10-25" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb10-26"><a href="#cb10-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-27"><a href="#cb10-27" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">cbind</span>((<span class="fu">colMeans</span>(time)), <span class="fu">matrix</span>(<span class="fu">rep</span>(<span class="fu">sapply</span>(n, <span class="cf">function</span>(x){x<span class="sc">*</span><span class="fu">log</span>(x)}), <span class="dv">1</span>),<span class="at">nrow=</span><span class="dv">5</span>)) <span class="co"># to create a dataframe used for regression</span></span>
<span id="cb10-28"><a href="#cb10-28" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(df) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;an&#39;</span>,<span class="st">&#39;tn&#39;</span>)</span>
<span id="cb10-29"><a href="#cb10-29" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(df)</span>
<span id="cb10-30"><a href="#cb10-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-31"><a href="#cb10-31" aria-hidden="true" tabindex="-1"></a>time_lm <span class="ot">&lt;-</span> <span class="fu">lm</span>(an<span class="sc">~</span>tn, df)</span>
<span id="cb10-32"><a href="#cb10-32" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(df<span class="sc">$</span>tn,df<span class="sc">$</span>an)</span>
<span id="cb10-33"><a href="#cb10-33" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(df<span class="sc">$</span>tn,<span class="fu">fitted</span>(time_lm))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
</div>
<div id="section-8" class="section level3">
<h3>5.6</h3>
<div id="compute-coveue1-u-and-vareue1-u-where-usim-uniform01-and-the-percent-reduction-in-variance-of-hattheta-using-antithetic-variates-compared-to-simple-mc." class="section level4">
<h4>Compute <span class="math inline">\(Cov(e^U,e^{1-U})\)</span> and <span class="math inline">\(Var(e^U+e^{1-U})\)</span>, where <span class="math inline">\(U\sim Uniform(0,1)\)</span> and the percent reduction in variance of <span class="math inline">\(\hat{\theta}\)</span> using antithetic variates compared to simple MC.</h4>
<p>Since<span class="math inline">\(U \sim U(0,1)\)</span>, we can easily get <span class="math inline">\(E(e^U)=\int_{0}^{1}e^udu=\int_{0}^{1}e^{1-u}du=e-1\)</span>, and <span class="math inline">\(E[e^{2U}]=\int_{0}^{1}e^{2u}du=\frac{e^2-1}{2}\)</span>.</p>
<p>So <span class="math display">\[var(e^U)=E[e^{2U}]-(E(e^U))^2=\frac{e^2-1}{2}-(e-1)^2\]</span></p>
<p><span class="math display">\[Cov(e^U,e^{1-U})=E[e^Ue^{1-U}]-E[e^U]E[e^{1-U}]=e-(e-1)^2\approx-0.2342\]</span></p>
<p><span class="math display">\[var(e^U+e^{1-U})=2var(e^U)+2Cov(e^U,e^{1-U})=e^2-1-2(e-1)^2+2[e-(e-1)^2]=-3e^2+10e-5\]</span></p>
<p>If we use antithetic variables <span class="math display">\[var(\frac{e^U+e^{1-U}}{2})=\frac{-3e^2+10e-5}{4}\approx0.0039\]</span></p>
<p>As for simple MC, <span class="math display">\[var(\frac{e^U_1+e^U_2}{2})=\frac{1}{2}var(e^U)=\frac{1}{2}[E[e^{2U}]-(E(e^U))^2]=\frac{e^2-1}{4}-\frac{1}{2}(e-1)^2\approx0.1210\]</span></p>
<p>In this way, the percent reduction is <span class="math inline">\(\frac{0.1210-0.0039}{0.1210}=96.78\%\)</span>.</p>
</div>
</div>
<div id="section-9" class="section level3">
<h3>5.7</h3>
<div id="use-a-monte-carlo-simulation-to-estimate-theta-by-the-antithetic-variate-approch-and-by-the-simple-monete-carlo-method.-and-compare-the-empirical-estimate-of-the-percent-reduction-in-variance-with-theoretical-value-in-5.6." class="section level4">
<h4>Use a Monte Carlo simulation to estimate <span class="math inline">\(\theta\)</span> by the antithetic variate approch and by the simple Monete Carlo method. And compare the empirical estimate of the percent reduction in variance with theoretical value in 5.6.</h4>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">100000</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">numeric</span>(N)</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>Y <span class="ot">&lt;-</span> <span class="fu">numeric</span>(N)</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>N) {</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>  U <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">2</span>)</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>  Y[i] <span class="ot">&lt;-</span> (<span class="fu">exp</span>(U[<span class="dv">1</span>])<span class="sc">+</span><span class="fu">exp</span>(<span class="dv">1</span><span class="sc">-</span>U[<span class="dv">1</span>]))<span class="sc">/</span><span class="dv">2</span></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>  X[i] <span class="ot">&lt;-</span> (<span class="fu">exp</span>(U[<span class="dv">1</span>])<span class="sc">+</span><span class="fu">exp</span>(U[<span class="dv">2</span>]))<span class="sc">/</span><span class="dv">2</span></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>varX <span class="ot">&lt;-</span> <span class="fu">var</span>(X)</span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>varY <span class="ot">&lt;-</span> <span class="fu">var</span>(Y)</span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">&#39;The theoretical value:&#39;</span>,<span class="fu">round</span>(<span class="fu">exp</span>(<span class="dv">1</span>)<span class="sc">-</span><span class="dv">1</span>,<span class="dv">4</span>)))</span></code></pre></div>
<pre><code>## [1] &quot;The theoretical value:1.7183&quot;</code></pre>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">&#39;The estimation calculated by antithetic variate approch:&#39;</span>,<span class="fu">round</span>(<span class="fu">mean</span>(X),<span class="dv">4</span>)))</span></code></pre></div>
<pre><code>## [1] &quot;The estimation calculated by antithetic variate approch:1.7165&quot;</code></pre>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">&#39;The estimation calculated by simple MC:&#39;</span>,<span class="fu">round</span>(<span class="fu">mean</span>(Y),<span class="dv">4</span>)))</span></code></pre></div>
<pre><code>## [1] &quot;The estimation calculated by simple MC:1.7181&quot;</code></pre>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">&#39;The empirical estimate of the percent reduction in variance:&#39;</span>,<span class="fu">round</span>((varX<span class="sc">-</span>varY)<span class="sc">/</span>varX,<span class="dv">4</span>)<span class="sc">*</span><span class="dv">100</span>,<span class="st">&#39;%.&#39;</span>))</span></code></pre></div>
<pre><code>## [1] &quot;The empirical estimate of the percent reduction in variance:96.77%.&quot;</code></pre>
</div>
</div>
</div>
</div>
<div id="section-10" class="section level1">
<h1>2022-09-30</h1>
<div id="question-3" class="section level2">
<h2>Question</h2>
<ol style="list-style-type: decimal">
<li>Exercises 5.13, 5.15(pages 149-151, Statistical Computating with R)</li>
</ol>
</div>
<div id="answer-3" class="section level2">
<h2>Answer</h2>
<div id="section-11" class="section level3">
<h3>5.13</h3>
<div id="find-two-importance-functions-f_1-and-f_2-that-are-supported-on-1infty-and-are-close-to-gxfracx2sqrt2pie-x22-quad-x1" class="section level4">
<h4>(1) Find two importance functions <span class="math inline">\(f_1\)</span> and <span class="math inline">\(f_2\)</span> that are supported on <span class="math inline">\((1,\infty)\)</span> and are ‘close’ to <span class="math display">\[g(x)=\frac{x^2}{\sqrt{2\pi}}e^{-x^2/2}, \quad x&gt;1\]</span></h4>
<p>We selected the density of Pareto distribution as <span class="math inline">\(f_1\)</span>, and picked up the density of Exponential distribution as <span class="math inline">\(f_2\)</span>. According to the question, both <span class="math inline">\(f_1\)</span> and <span class="math inline">\(f_2\)</span> need to support on <span class="math inline">\((1,\infty)\)</span>. So as for <span class="math inline">\(f_1\)</span>, we let <span class="math inline">\(a=1, \theta=1\)</span>, so we can get <span class="math display">\[f_1(x)=e^{-(x-1)}I_{(1,\infty)}(x)\]</span>. As for <span class="math inline">\(f_2\)</span>, we let <span class="math inline">\(\theta=3, a=1\)</span>, so we can get <span class="math display">\[f_2(x)=3x^{-4}I_{(1,\infty)}(x)\]</span></p>
</div>
<div id="compare-the-two-functions-and-figure-out-that-which-function-should-produce-the-smaller-variance-in-estimating-int_1inftyfracx2sqrt2pie-x22dx" class="section level4">
<h4>(2) Compare the two functions and figure out that which function should produce the smaller variance in estimating <span class="math display">\[\int_{1}^{\infty}\frac{x^2}{\sqrt{2\pi}}e^{-x^2/2}dx\]</span></h4>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>g <span class="ot">&lt;-</span> <span class="cf">function</span> (x){</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>  x <span class="sc">^</span> <span class="dv">2</span> <span class="sc">/</span> <span class="fu">sqrt</span>(<span class="dv">2</span><span class="sc">*</span>pi) <span class="sc">*</span> <span class="fu">exp</span>(<span class="sc">-</span>x<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>f1 <span class="ot">&lt;-</span> <span class="cf">function</span>(x){</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">exp</span>(<span class="sc">-</span>(x<span class="dv">-1</span>))</span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>f2 <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a>  <span class="dv">3</span> <span class="sc">*</span> x<span class="sc">^</span>(<span class="sc">-</span><span class="dv">4</span>)</span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a>xs <span class="ot">=</span> <span class="fu">seq</span>(<span class="dv">1</span>,<span class="dv">10</span>,<span class="fl">0.1</span>)</span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true" tabindex="-1"></a>y_g <span class="ot">&lt;-</span> <span class="fu">g</span>(xs)</span>
<span id="cb19-16"><a href="#cb19-16" aria-hidden="true" tabindex="-1"></a>y_f1 <span class="ot">&lt;-</span> <span class="fu">f1</span>(xs)</span>
<span id="cb19-17"><a href="#cb19-17" aria-hidden="true" tabindex="-1"></a>y_f2 <span class="ot">&lt;-</span> <span class="fu">f2</span>(xs)</span>
<span id="cb19-18"><a href="#cb19-18" aria-hidden="true" tabindex="-1"></a>lim <span class="ot">=</span> <span class="fu">max</span>(<span class="fu">c</span>(y_g, y_f1, y_f2))</span>
<span id="cb19-19"><a href="#cb19-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-20"><a href="#cb19-20" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(xs, y_g, <span class="at">type =</span> <span class="st">&quot;l&quot;</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, lim))</span>
<span id="cb19-21"><a href="#cb19-21" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(xs, y_f1, <span class="at">col=</span><span class="st">&quot;red&quot;</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, lim))</span>
<span id="cb19-22"><a href="#cb19-22" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(xs, y_f2, <span class="at">col=</span><span class="st">&quot;blue&quot;</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, lim))</span>
<span id="cb19-23"><a href="#cb19-23" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&#39;topright&#39;</span>, <span class="at">legend=</span><span class="fu">c</span>(<span class="st">&#39;g&#39;</span>, <span class="st">&#39;f1&#39;</span>, <span class="st">&#39;f2&#39;</span>), <span class="at">fill=</span><span class="fu">c</span>(<span class="st">&#39;black&#39;</span>,<span class="st">&#39;red&#39;</span>,<span class="st">&#39;blue&#39;</span>))</span>
<span id="cb19-24"><a href="#cb19-24" aria-hidden="true" tabindex="-1"></a><span class="fu">title</span>(<span class="at">ylab =</span> <span class="st">&#39;y&#39;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>From the figure above, we can easily see that <span class="math inline">\(f_1\)</span> is much closer to <span class="math inline">\(g\)</span> than <span class="math inline">\(f_2\)</span>, so <span class="math inline">\(f_1\)</span> should produce the smaller variance in estimating.</p>
</div>
</div>
<div id="section-12" class="section level3">
<h3>5.15</h3>
<div id="obtain-the-stratified-importance-sampling-estimate-in-example-5.13-and-compare-it-with-the-result-of-example-5.10" class="section level4">
<h4>Obtain the stratified importance sampling estimate in Example 5.13 and compare it with the result of Example 5.10</h4>
<p>From the Example 5.10 we can know that the aim is to estimate <span class="math inline">\(\int_{0}^{1}\frac{e^{-x}}{1+x^2}dx\)</span>, and the question choose 5 importance functions to estimate it. And we can know from the Example 5.10 that the importance function <span class="math inline">\(f_3(x)=e^{-x}/(1-e^{-1}), \quad 0&lt;x&lt;1.\)</span></p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>g <span class="ot">&lt;-</span> <span class="cf">function</span>(x){</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">exp</span>(<span class="sc">-</span>x <span class="sc">-</span> <span class="fu">log</span>(<span class="dv">1</span> <span class="sc">+</span> x<span class="sc">^</span><span class="dv">2</span>)) <span class="sc">*</span> (x <span class="sc">&gt;</span> <span class="dv">0</span>) <span class="sc">*</span> (x <span class="sc">&lt;</span> <span class="dv">1</span>)</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>u <span class="ot">&lt;-</span> <span class="fu">runif</span>(m)  <span class="co"># f3, inverse transform method</span></span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="sc">-</span><span class="fu">log</span>(<span class="dv">1</span> <span class="sc">-</span> u <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> <span class="fu">exp</span>(<span class="sc">-</span><span class="dv">1</span>)))</span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>fg <span class="ot">&lt;-</span> <span class="fu">g</span>(x) <span class="sc">/</span> (<span class="fu">exp</span>(<span class="sc">-</span>x) <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">-</span> <span class="fu">exp</span>(<span class="sc">-</span><span class="dv">1</span>)))</span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>theta.hat510 <span class="ot">&lt;-</span> <span class="fu">mean</span>(fg)</span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>se510 <span class="ot">&lt;-</span> <span class="fu">sd</span>(fg)</span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Stratified importance sampling</span></span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="dv">5</span>  <span class="co"># number of strata</span></span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> m <span class="sc">/</span> k  <span class="co"># replicates per stratum</span></span>
<span id="cb20-14"><a href="#cb20-14" aria-hidden="true" tabindex="-1"></a>theta.hat513 <span class="ot">&lt;-</span> se513 <span class="ot">&lt;-</span> <span class="fu">numeric</span>(k)</span>
<span id="cb20-15"><a href="#cb20-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-16"><a href="#cb20-16" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k) {</span>
<span id="cb20-17"><a href="#cb20-17" aria-hidden="true" tabindex="-1"></a>  u <span class="ot">&lt;-</span> <span class="fu">runif</span>(N, (j <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">/</span> k, j <span class="sc">/</span> k)</span>
<span id="cb20-18"><a href="#cb20-18" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="sc">-</span><span class="fu">log</span>(<span class="dv">1</span> <span class="sc">-</span> u <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> <span class="fu">exp</span>(<span class="sc">-</span><span class="dv">1</span>)))</span>
<span id="cb20-19"><a href="#cb20-19" aria-hidden="true" tabindex="-1"></a>  fg <span class="ot">&lt;-</span> <span class="fu">g</span>(x) <span class="sc">/</span> (k <span class="sc">*</span> <span class="fu">exp</span>(<span class="sc">-</span>x) <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">-</span> <span class="fu">exp</span>(<span class="sc">-</span><span class="dv">1</span>)))</span>
<span id="cb20-20"><a href="#cb20-20" aria-hidden="true" tabindex="-1"></a>  theta.hat513[j] <span class="ot">&lt;-</span> <span class="fu">mean</span>(fg)</span>
<span id="cb20-21"><a href="#cb20-21" aria-hidden="true" tabindex="-1"></a>  se513[j] <span class="ot">&lt;-</span> <span class="fu">sd</span>(fg)</span>
<span id="cb20-22"><a href="#cb20-22" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb20-23"><a href="#cb20-23" aria-hidden="true" tabindex="-1"></a>theta.hat513 <span class="ot">&lt;-</span> <span class="fu">sum</span>(theta.hat513)</span>
<span id="cb20-24"><a href="#cb20-24" aria-hidden="true" tabindex="-1"></a>se513 <span class="ot">&lt;-</span> <span class="fu">sum</span>(se513)</span>
<span id="cb20-25"><a href="#cb20-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-26"><a href="#cb20-26" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">&#39;The estimation obtained in Example 5.10:&#39;</span>, <span class="fu">round</span>(theta.hat510,<span class="dv">6</span>), <span class="st">&#39;; The estimation obtained in Example 5.13: &#39;</span>, <span class="fu">round</span>(theta.hat513,<span class="dv">6</span>), <span class="st">&#39;.&#39;</span>))</span></code></pre></div>
<pre><code>## [1] &quot;The estimation obtained in Example 5.10:0.524277; The estimation obtained in Example 5.13: 0.524756.&quot;</code></pre>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">&#39;The estimation  se obtained in Example 5.10:&#39;</span>, <span class="fu">round</span>(se510,<span class="dv">6</span>), <span class="st">&#39;; The estimation se obtained in Example 5.13: &#39;</span>, <span class="fu">round</span>(se513,<span class="dv">6</span>), <span class="st">&#39;.&#39;</span>))</span></code></pre></div>
<pre><code>## [1] &quot;The estimation  se obtained in Example 5.10:0.096704; The estimation se obtained in Example 5.13: 0.018266.&quot;</code></pre>
<p>From the result, we can easily see that using stratified importance sampling can truly get a better estimation from the variance of estimation obtained in Example 5.13 is much smaller than that in 5.10.</p>
</div>
</div>
</div>
</div>
<div id="section-13" class="section level1">
<h1>2022-10-09</h1>
<div id="question-4" class="section level2">
<h2>Question</h2>
<ol style="list-style-type: decimal">
<li><p>Exercises 6.4, 6.8(pages 180-181, Statistical Computating with R)</p></li>
<li><p>Discussion</p></li>
</ol>
</div>
<div id="answer-4" class="section level2">
<h2>Answer</h2>
<div id="section-14" class="section level3">
<h3>6.4</h3>
<div id="suppose-that-x_1...x_n-are-a-random-sample-from-a-lognormal-distribution-with-unknown-parameters.-construct-a-95-confidence-interval-for-the-parameter-mu.-use-a-monte-carlo-method-to-obtain-an-empirical-estimate-of-the-confidence-level." class="section level4">
<h4>Suppose that <span class="math inline">\(X_1,...,X_n\)</span> are a random sample from a lognormal distribution with unknown parameters. Construct a 95% confidence interval for the parameter <span class="math inline">\(\mu\)</span>. Use a Monte Carlo method to obtain an empirical estimate of the confidence level.</h4>
<p>From the question we can know that <span class="math inline">\(Y=\ln(x)\sim N(\mu,\sigma^2)\)</span>, where both <span class="math inline">\(\mu\)</span> and <span class="math inline">\(\sigma^2\)</span> are unknown. In this case we define T-statistic<span class="math inline">\(T:=\frac{\sqrt{n}(\overline{Y}-\mu)}{S}\sim N(0,1)\)</span>, where <span class="math inline">\(S=\frac{1}{n-1}\sum_{i=1}^{n}(Y_i-\overline{Y})^2\)</span>. So the distribution of T-statistic is t-distribution and the degree of freedom is n-1, which can help us get the confidence interval.</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>exercise_6_4 <span class="ot">&lt;-</span> <span class="cf">function</span>(seed,n){</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(seed)</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="fl">0.05</span></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>cv.t <span class="ot">&lt;-</span> <span class="fu">sapply</span>(<span class="dv">1</span><span class="sc">:</span>m,<span class="at">FUN=</span> <span class="cf">function</span>(o){</span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>  y <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n)</span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>  c <span class="ot">&lt;-</span> <span class="fu">qt</span>(<span class="fl">0.975</span>,n<span class="dv">-1</span>) </span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>  m <span class="ot">&lt;-</span> <span class="fu">mean</span>(y) </span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>  se <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">var</span>(y)) </span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.numeric</span>((m<span class="sc">-</span>c<span class="sc">*</span>se<span class="sc">/</span><span class="fu">sqrt</span>(n)<span class="sc">&lt;</span><span class="dv">0</span>)<span class="sc">&amp;</span>(m<span class="sc">+</span>c<span class="sc">*</span>se<span class="sc">/</span><span class="fu">sqrt</span>(n)<span class="sc">&gt;</span><span class="dv">0</span>)) </span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a>level <span class="ot">&lt;-</span> <span class="fu">mean</span>(cv.t) </span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-14"><a href="#cb24-14" aria-hidden="true" tabindex="-1"></a><span class="fu">return</span>(level)</span>
<span id="cb24-15"><a href="#cb24-15" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb24-16"><a href="#cb24-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-17"><a href="#cb24-17" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (n <span class="cf">in</span> <span class="fu">c</span>(<span class="dv">10</span>,<span class="dv">50</span>,<span class="dv">100</span>,<span class="dv">1000</span>,<span class="dv">10000</span>)) {</span>
<span id="cb24-18"><a href="#cb24-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">&#39;When n is &#39;</span>, n, <span class="st">&#39;, the empirical estimate of the confidence level is: &#39;</span>, <span class="fu">exercise_6_4</span>(<span class="dv">1</span>,n)))</span>
<span id="cb24-19"><a href="#cb24-19" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## [1] &quot;When n is 10, the empirical estimate of the confidence level is: 0.9518&quot;
## [1] &quot;When n is 50, the empirical estimate of the confidence level is: 0.9491&quot;
## [1] &quot;When n is 100, the empirical estimate of the confidence level is: 0.9487&quot;
## [1] &quot;When n is 1000, the empirical estimate of the confidence level is: 0.9525&quot;
## [1] &quot;When n is 10000, the empirical estimate of the confidence level is: 0.9515&quot;</code></pre>
<p>From the result above, we can easily see that the empirical estimate is pretty near to 0.95, even when n is small.</p>
</div>
</div>
<div id="section-15" class="section level3">
<h3>6.8</h3>
<div id="refer-to-example-6.16.-repeat-the-simulation-but-also-compute-the-f-test-of-equal-variance-at-significance-level-hatadoteq-0.055.-compare-the-power-of-the-count-five-test-and-f-test-for-small-medium-large-sizes." class="section level4">
<h4>Refer to Example 6.16. Repeat the simulation, but also compute the F test of equal variance, at significance level <span class="math inline">\(\hat{a}\doteq 0.055\)</span>. Compare the power of the Count Five test and F test for small, medium, large sizes.</h4>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>exercise_6_8 <span class="ot">&lt;-</span> <span class="cf">function</span>(){</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>count5test <span class="ot">&lt;-</span> <span class="cf">function</span>(x,y){</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>  X <span class="ot">&lt;-</span> x <span class="sc">-</span> <span class="fu">mean</span>(x)</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>  Y <span class="ot">&lt;-</span> y <span class="sc">-</span> <span class="fu">mean</span>(y)</span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>  outx <span class="ot">&lt;-</span> <span class="fu">sum</span>(X <span class="sc">&gt;</span> <span class="fu">max</span>(Y)) <span class="sc">+</span> <span class="fu">sum</span>(X <span class="sc">&lt;</span> <span class="fu">min</span>(Y))</span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>  outy <span class="ot">&lt;-</span> <span class="fu">sum</span>(Y <span class="sc">&gt;</span> <span class="fu">max</span>(X)) <span class="sc">+</span> <span class="fu">sum</span>(Y <span class="sc">&lt;</span> <span class="fu">min</span>(X))</span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">as.integer</span>(<span class="fu">max</span>(<span class="fu">c</span>(outx,outy)) <span class="sc">&gt;</span> <span class="dv">5</span>))</span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">20</span>,<span class="dv">200</span>,<span class="dv">1000</span>)<span class="co">#分别对应小样本、中样本和大样本</span></span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a>mu1 <span class="ot">&lt;-</span> mu2 <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a>sigma1 <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb26-12"><a href="#cb26-12" aria-hidden="true" tabindex="-1"></a>sigma2 <span class="ot">&lt;-</span> <span class="fl">1.5</span></span>
<span id="cb26-13"><a href="#cb26-13" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb26-14"><a href="#cb26-14" aria-hidden="true" tabindex="-1"></a>power1 <span class="ot">&lt;-</span> power2 <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="fu">length</span>(n))</span>
<span id="cb26-15"><a href="#cb26-15" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb26-16"><a href="#cb26-16" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(n)){</span>
<span id="cb26-17"><a href="#cb26-17" aria-hidden="true" tabindex="-1"></a>  power1[i] <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">replicate</span>(m,<span class="at">expr =</span> {</span>
<span id="cb26-18"><a href="#cb26-18" aria-hidden="true" tabindex="-1"></a>    x <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n[i],mu1,sigma1)</span>
<span id="cb26-19"><a href="#cb26-19" aria-hidden="true" tabindex="-1"></a>    y <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n[i],mu2,sigma2)</span>
<span id="cb26-20"><a href="#cb26-20" aria-hidden="true" tabindex="-1"></a>    x <span class="ot">&lt;-</span> x <span class="sc">-</span> <span class="fu">mean</span>(x)</span>
<span id="cb26-21"><a href="#cb26-21" aria-hidden="true" tabindex="-1"></a>    y <span class="ot">&lt;-</span> y <span class="sc">-</span> <span class="fu">mean</span>(y)</span>
<span id="cb26-22"><a href="#cb26-22" aria-hidden="true" tabindex="-1"></a>    <span class="fu">count5test</span>(x,y)</span>
<span id="cb26-23"><a href="#cb26-23" aria-hidden="true" tabindex="-1"></a>  }))</span>
<span id="cb26-24"><a href="#cb26-24" aria-hidden="true" tabindex="-1"></a>  pvalues <span class="ot">&lt;-</span> <span class="fu">replicate</span>(m,<span class="at">expr=</span>{</span>
<span id="cb26-25"><a href="#cb26-25" aria-hidden="true" tabindex="-1"></a>    x <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n[i],mu1,sigma1)</span>
<span id="cb26-26"><a href="#cb26-26" aria-hidden="true" tabindex="-1"></a>    y <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n[i],mu2,sigma2)</span>
<span id="cb26-27"><a href="#cb26-27" aria-hidden="true" tabindex="-1"></a>    Ftest <span class="ot">&lt;-</span> <span class="fu">var.test</span>(x, y, <span class="at">ratio =</span> <span class="dv">1</span>,</span>
<span id="cb26-28"><a href="#cb26-28" aria-hidden="true" tabindex="-1"></a>                      <span class="at">alternative =</span> <span class="fu">c</span>(<span class="st">&quot;two.sided&quot;</span>),</span>
<span id="cb26-29"><a href="#cb26-29" aria-hidden="true" tabindex="-1"></a>                      <span class="at">conf.level =</span> <span class="fl">0.945</span>, ...)</span>
<span id="cb26-30"><a href="#cb26-30" aria-hidden="true" tabindex="-1"></a>    Ftest<span class="sc">$</span>p.value})</span>
<span id="cb26-31"><a href="#cb26-31" aria-hidden="true" tabindex="-1"></a>  power2[i] <span class="ot">&lt;-</span> <span class="fu">mean</span>(pvalues<span class="sc">&lt;=</span><span class="fl">0.055</span>)</span>
<span id="cb26-32"><a href="#cb26-32" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb26-33"><a href="#cb26-33" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(power1,power2)</span>
<span id="cb26-34"><a href="#cb26-34" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(df) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;Count Five test&#39;</span>,<span class="st">&#39;F test&#39;</span>)</span>
<span id="cb26-35"><a href="#cb26-35" aria-hidden="true" tabindex="-1"></a><span class="fu">return</span>(df)</span>
<span id="cb26-36"><a href="#cb26-36" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb26-37"><a href="#cb26-37" aria-hidden="true" tabindex="-1"></a><span class="fu">exercise_6_8</span>()</span></code></pre></div>
<pre><code>##   Count Five test F test
## 1          0.3128 0.4118
## 2          0.9475 0.9999
## 3          0.9980 1.0000</code></pre>
<p>From the result, we can easily see that the empirical power of F test is always larger. As n increases, the empirical power of two test are getting closer.</p>
</div>
</div>
<div id="discussion" class="section level3">
<h3>Discussion</h3>
<div id="if-we-obtain-the-powers-for-two-methods-under-a-particular-simulation-setting-with-10000-experiments-say-0.651-for-one-method-and-0.676-for-another-method.-can-we-say-the-powers-are-different-at-0.05-level" class="section level4">
<h4>* If we obtain the powers for two methods under a particular simulation setting with 10,000 experiments: say, 0.651 for one method and 0.676 for another method. Can we say the powers are different at 0.05 level?</h4>
</div>
<div id="what-is-the-corresponding-hypothesis-test-problem" class="section level4">
<h4>* What is the corresponding hypothesis test problem?</h4>
</div>
<div id="which-test-can-we-use-z-test-two-sample-t-test-paired-t-test-or-mcnemar-test-why" class="section level4">
<h4>* Which test can we use? Z-test, two-sample t-test, paired-t test or McNemar test? Why?</h4>
</div>
<div id="please-provide-the-least-necessary-information-for-hypothesis-testing." class="section level4">
<h4>* Please provide the least necessary information for hypothesis testing.</h4>
<p>Obviously we cannot say the powers are different at 0.05 level without any test. Since we want to figure out whether the powers are different, we can construct hypothesis test problem like below:</p>
<center>
<span class="math inline">\(H_0\)</span>: The two methods have the same power.<span class="math inline">\(\quad \leftrightarrow \quad H_1\)</span>: The two methods have different powers.
</center>
<p>After that we should use McNemar test for this hypothesis test problem, Because McNemar test is equivalent to test whether the acceptance rates of the two methods are the same, and the two powers can be reorganized into a 2 × 2 contingency table like below:</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>table <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">6510</span>, <span class="dv">3490</span>, <span class="dv">10000</span>, <span class="dv">6760</span>, <span class="dv">3240</span>, <span class="dv">10000</span>, <span class="dv">13270</span>, <span class="dv">6730</span>, <span class="dv">20000</span>), <span class="dv">3</span>, <span class="dv">3</span>,</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>         <span class="at">dimnames =</span> <span class="fu">list</span>(<span class="fu">c</span>(<span class="st">&quot;Rejected&quot;</span>, <span class="st">&quot;Accepted&quot;</span>, <span class="st">&quot;total&quot;</span>), <span class="fu">c</span>(<span class="st">&quot;method A&quot;</span>, <span class="st">&quot;method B&quot;</span>, <span class="st">&quot;total&quot;</span>)))</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>table</span></code></pre></div>
<pre><code>##          method A method B total
## Rejected     6510     6760 13270
## Accepted     3490     3240  6730
## total       10000    10000 20000</code></pre>
<p>The test statistic: <span class="math display">\[\chi^2=\sum_{i,j=1}^{2}\frac{(n\cdot n_{ij}-n_i\cdot n_j)^2}{n\cdot n_i \cdot n_j}\sim \chi^2_{1}\]</span></p>
<p>After calculating we obtain that <span class="math inline">\(\chi^2=13.9966\)</span> and the p-value is<span class="math inline">\(P(\chi^2_1&gt;\chi^2)=0.0002&lt;0.05\)</span>.</p>
<p>So we reject <span class="math inline">\(H_0\)</span>, which means the power are different at 0.05 level.</p>
</div>
</div>
</div>
</div>
<div id="section-16" class="section level1">
<h1>2022-10-14</h1>
<div id="question-5" class="section level2">
<h2>Question</h2>
<ul>
<li>Exercises 7.4, 7.5, 7.A(pages 212-213, Statistical Computating with R)</li>
</ul>
</div>
<div id="answer-5" class="section level2">
<h2>Answer</h2>
<div id="section-17" class="section level3">
<h3>7.4</h3>
<div id="assume-that-the-times-between-failures-follow-an-exponential-model-explambda.-obtain-the-mle-of-the-hazard-rate-lambda-and-use-bootstrap-to-estimate-the-bias-and-standard-error-of-the-estimate." class="section level4">
<h4>Assume that the times between failures follow an exponential model <span class="math inline">\(Exp(\lambda)\)</span>. Obtain the MLE of the hazard rate <span class="math inline">\(\lambda\)</span> and use bootstrap to estimate the bias and standard error of the estimate.</h4>
<p>It’s obvious that the likelihood function is:<span class="math display">\[L(\lambda)=\prod^{n}_{i=1}f(x_i)=\frac{1}{\lambda^n}e^{-\frac{\sum_{i=1}^{n}x_i}{\lambda}}\]</span></p>
<p>Let <span class="math inline">\(\frac{\partial L(\lambda)}{\partial \lambda}=0\)</span>, we can obtain the MLE of <span class="math inline">\(\lambda\)</span>: <span class="math display">\[\hat{\lambda}_{MLE}=\overline{X}\]</span></p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>example_7_4 <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">seed=</span><span class="dv">123</span>){</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(seed)</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(boot)</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>hours <span class="ot">&lt;-</span> aircondit<span class="sc">$</span>hours</span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>B <span class="ot">=</span> <span class="dv">1000</span></span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a><span class="co"># MLE </span></span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a>mle_lambda <span class="ot">&lt;-</span> <span class="cf">function</span> (x) {</span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">mean</span>(x))</span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-11"><a href="#cb30-11" aria-hidden="true" tabindex="-1"></a>lambda_hat_mle <span class="ot">&lt;-</span> <span class="fu">mle_lambda</span>(hours)</span>
<span id="cb30-12"><a href="#cb30-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-13"><a href="#cb30-13" aria-hidden="true" tabindex="-1"></a>lambda_hat_b <span class="ot">&lt;-</span> <span class="fu">numeric</span>(B)</span>
<span id="cb30-14"><a href="#cb30-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-15"><a href="#cb30-15" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (b <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>B) {</span>
<span id="cb30-16"><a href="#cb30-16" aria-hidden="true" tabindex="-1"></a>  hours_b <span class="ot">&lt;-</span> <span class="fu">sample</span>(hours, <span class="fu">length</span>(hours), <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb30-17"><a href="#cb30-17" aria-hidden="true" tabindex="-1"></a>  lambda_hat_b[b] <span class="ot">&lt;-</span> <span class="fu">mle_lambda</span>(hours_b)</span>
<span id="cb30-18"><a href="#cb30-18" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb30-19"><a href="#cb30-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-20"><a href="#cb30-20" aria-hidden="true" tabindex="-1"></a>lambda_hat_b_mean <span class="ot">&lt;-</span> <span class="fu">mean</span>(lambda_hat_b)</span>
<span id="cb30-21"><a href="#cb30-21" aria-hidden="true" tabindex="-1"></a>bias <span class="ot">&lt;-</span> lambda_hat_b_mean <span class="sc">-</span> lambda_hat_mle</span>
<span id="cb30-22"><a href="#cb30-22" aria-hidden="true" tabindex="-1"></a>standard_error <span class="ot">&lt;-</span> <span class="fu">sd</span>(lambda_hat_b)</span>
<span id="cb30-23"><a href="#cb30-23" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">&#39;The MLE of the rate: &#39;</span>, <span class="fu">round</span>(lambda_hat_mle,<span class="dv">4</span>)))</span>
<span id="cb30-24"><a href="#cb30-24" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">&#39;The estimate of the rate using bootstrap: &#39;</span>, <span class="fu">round</span>(lambda_hat_b_mean,<span class="dv">4</span>)))</span>
<span id="cb30-25"><a href="#cb30-25" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">&#39;The bias of estimate using bootstrap: &#39;</span>, bias))</span>
<span id="cb30-26"><a href="#cb30-26" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">&#39;The standard error of the estimate using bootstrap: &#39;</span>, <span class="fu">round</span>(standard_error,<span class="dv">4</span>)))</span>
<span id="cb30-27"><a href="#cb30-27" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb30-28"><a href="#cb30-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-29"><a href="#cb30-29" aria-hidden="true" tabindex="-1"></a><span class="fu">example_7_4</span>()</span></code></pre></div>
<pre><code>## [1] &quot;The MLE of the rate: 108.0833&quot;
## [1] &quot;The estimate of the rate using bootstrap: 105.9536&quot;
## [1] &quot;The bias of estimate using bootstrap: -2.12975&quot;
## [1] &quot;The standard error of the estimate using bootstrap: 38.3636&quot;</code></pre>
</div>
</div>
<div id="section-18" class="section level3">
<h3>7.5</h3>
<div id="refer-to-exercise-7.4.-compute-95-bootstrap-confidence-intervals-for-the-mean-time-between-failures-frac1lambda-by-the-standard-normal-basic-percentile-and-bca-methods.-compare-the-intervals-and-explain-why-they-differ." class="section level4">
<h4>Refer to Exercise 7.4. Compute 95% bootstrap confidence intervals for the mean time between failures <span class="math inline">\(\frac{1}{\lambda}\)</span> by the standard normal, basic, percentile, and BCa methods. Compare the intervals and explain why they differ.</h4>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>example_7_5 <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">seed=</span><span class="dv">123</span>){</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(boot) <span class="co">#for boot and boot.ci</span></span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>hours <span class="ot">&lt;-</span> aircondit<span class="sc">$</span>hours</span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>theta_boot <span class="ot">&lt;-</span> <span class="cf">function</span>(hours, index) {</span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a>  <span class="co">#function to compute the statistic</span></span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mean</span>(hours[index])</span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a>boot_obj <span class="ot">&lt;-</span> <span class="fu">boot</span>(hours, <span class="at">statistic =</span> theta_boot, <span class="at">R =</span> <span class="dv">10000</span>)</span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(boot_obj)</span>
<span id="cb32-11"><a href="#cb32-11" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">boot.ci</span>(boot_obj,</span>
<span id="cb32-12"><a href="#cb32-12" aria-hidden="true" tabindex="-1"></a>              <span class="at">type =</span> <span class="fu">c</span>(<span class="st">&quot;basic&quot;</span>, <span class="st">&quot;norm&quot;</span>, <span class="st">&quot;perc&quot;</span>,<span class="st">&#39;bca&#39;</span>)))</span>
<span id="cb32-13"><a href="#cb32-13" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb32-14"><a href="#cb32-14" aria-hidden="true" tabindex="-1"></a><span class="fu">example_7_5</span>()</span></code></pre></div>
<pre><code>## 
## ORDINARY NONPARAMETRIC BOOTSTRAP
## 
## 
## Call:
## boot(data = hours, statistic = theta_boot, R = 10000)
## 
## 
## Bootstrap Statistics :
##     original     bias    std. error
## t1* 108.0833 -0.6636167    37.59958
## BOOTSTRAP CONFIDENCE INTERVAL CALCULATIONS
## Based on 10000 bootstrap replicates
## 
## CALL : 
## boot.ci(boot.out = boot_obj, type = c(&quot;basic&quot;, &quot;norm&quot;, &quot;perc&quot;, 
##     &quot;bca&quot;))
## 
## Intervals : 
## Level      Normal              Basic         
## 95%   ( 35.1, 182.4 )   ( 25.8, 170.1 )  
## 
## Level     Percentile            BCa          
## 95%   ( 46.1, 190.4 )   ( 56.2, 221.4 )  
## Calculations and Intervals on Original Scale</code></pre>
<p>From the result, we can easily see that using basic method we are likely to get a interval that contains smallest numbers, while we tend to get a interval contains largest numbers if we use BCa method. And after calculating, the interval obtained using basic method is the smallest.</p>
</div>
</div>
<div id="a" class="section level3">
<h3>7.A</h3>
<div id="conduct-a-monte-carlo-study-to-estimate-the-coverage-probabilities-of-the-standard-normal-bootstrap-confidence-interval-the-basic-bootstrap-confidence-interval-and-the-percentile-confidence-interval.-sample-from-a-normal-population-and-check-the-empirical-coverage-rates-for-the-sampke-mean.-find-the-proportion-of-times-that-the-confidence-intervals-miss-on-the-left-and-the-porportion-of-times-that-the-confidence-intervals-miss-on-the-right." class="section level4">
<h4>Conduct a Monte Carlo study to estimate the coverage probabilities of the standard normal bootstrap confidence interval, the basic bootstrap confidence interval, and the percentile confidence interval. Sample from a normal population and check the empirical coverage rates for the sampke mean. Find the proportion of times that the confidence intervals miss on the left, and the porportion of times that the confidence intervals miss on the right.</h4>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>mu <span class="ot">=</span> <span class="dv">4</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>sigma <span class="ot">=</span> <span class="dv">3</span></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>n <span class="ot">=</span> <span class="dv">10000</span></span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>xs <span class="ot">=</span> <span class="fu">rnorm</span>(n, <span class="at">mean =</span> mu, <span class="at">sd =</span> <span class="fu">sqrt</span>(sigma))</span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a><span class="co"># sample mean.</span></span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a>mu.hat <span class="ot">=</span> <span class="fu">mean</span>(xs)</span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a><span class="co"># compute bootstrap sample of the mean.</span></span>
<span id="cb34-11"><a href="#cb34-11" aria-hidden="true" tabindex="-1"></a>B <span class="ot">=</span> <span class="dv">200</span></span>
<span id="cb34-12"><a href="#cb34-12" aria-hidden="true" tabindex="-1"></a>mu.hats.b <span class="ot">=</span> <span class="fu">numeric</span>(B)</span>
<span id="cb34-13"><a href="#cb34-13" aria-hidden="true" tabindex="-1"></a>ts <span class="ot">=</span> <span class="fu">numeric</span>(B)</span>
<span id="cb34-14"><a href="#cb34-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-15"><a href="#cb34-15" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (b <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>B) {</span>
<span id="cb34-16"><a href="#cb34-16" aria-hidden="true" tabindex="-1"></a>  i <span class="ot">=</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span>n, n, <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb34-17"><a href="#cb34-17" aria-hidden="true" tabindex="-1"></a>  xs.b <span class="ot">=</span> xs[i]</span>
<span id="cb34-18"><a href="#cb34-18" aria-hidden="true" tabindex="-1"></a>  mu.hats.b[b] <span class="ot">=</span> <span class="fu">mean</span>(xs.b)</span>
<span id="cb34-19"><a href="#cb34-19" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb34-20"><a href="#cb34-20" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (b2 <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>B) {</span>
<span id="cb34-21"><a href="#cb34-21" aria-hidden="true" tabindex="-1"></a>    i2 <span class="ot">=</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span>n, n, <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb34-22"><a href="#cb34-22" aria-hidden="true" tabindex="-1"></a>    ts[b] <span class="ot">=</span> (mu.hats.b[b] <span class="sc">-</span> mu.hat) <span class="sc">/</span> <span class="fu">sd</span>(xs.b[i])</span>
<span id="cb34-23"><a href="#cb34-23" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb34-24"><a href="#cb34-24" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb34-25"><a href="#cb34-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-26"><a href="#cb34-26" aria-hidden="true" tabindex="-1"></a>se.hat <span class="ot">=</span> <span class="fu">sd</span>(mu.hats.b)</span>
<span id="cb34-27"><a href="#cb34-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-28"><a href="#cb34-28" aria-hidden="true" tabindex="-1"></a><span class="co"># visualize.</span></span>
<span id="cb34-29"><a href="#cb34-29" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">1</span>))</span>
<span id="cb34-30"><a href="#cb34-30" aria-hidden="true" tabindex="-1"></a><span class="co"># hist(mu.hats.b, breaks = 100)</span></span>
<span id="cb34-31"><a href="#cb34-31" aria-hidden="true" tabindex="-1"></a><span class="co"># hist(ts, breaks = 100)</span></span>
<span id="cb34-32"><a href="#cb34-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-33"><a href="#cb34-33" aria-hidden="true" tabindex="-1"></a><span class="co"># compute CIs.</span></span>
<span id="cb34-34"><a href="#cb34-34" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">=</span> <span class="fl">0.05</span></span>
<span id="cb34-35"><a href="#cb34-35" aria-hidden="true" tabindex="-1"></a>probs <span class="ot">=</span> <span class="fu">c</span>(alpha<span class="sc">/</span><span class="dv">2</span>, <span class="dv">1</span><span class="sc">-</span>alpha<span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb34-36"><a href="#cb34-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-37"><a href="#cb34-37" aria-hidden="true" tabindex="-1"></a>names <span class="ot">=</span> <span class="fu">sapply</span>(probs, <span class="cf">function</span>(p) <span class="fu">paste</span>(p<span class="sc">*</span><span class="dv">100</span>, <span class="st">&#39;%&#39;</span>, <span class="at">sep =</span> <span class="st">&#39;&#39;</span>))</span>
<span id="cb34-38"><a href="#cb34-38" aria-hidden="true" tabindex="-1"></a>setCINames <span class="ot">=</span> <span class="cf">function</span> (object) {</span>
<span id="cb34-39"><a href="#cb34-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span> (<span class="fu">setNames</span>(<span class="at">object =</span> object, names))</span>
<span id="cb34-40"><a href="#cb34-40" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb34-41"><a href="#cb34-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-42"><a href="#cb34-42" aria-hidden="true" tabindex="-1"></a><span class="co"># standard normal.</span></span>
<span id="cb34-43"><a href="#cb34-43" aria-hidden="true" tabindex="-1"></a>qs.norm <span class="ot">=</span> <span class="fu">qnorm</span>(probs)</span>
<span id="cb34-44"><a href="#cb34-44" aria-hidden="true" tabindex="-1"></a>ci.sn <span class="ot">=</span> <span class="fu">setCINames</span>(mu.hat <span class="sc">-</span> <span class="fu">rev</span>(qs.norm)<span class="sc">*</span>se.hat)</span>
<span id="cb34-45"><a href="#cb34-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-46"><a href="#cb34-46" aria-hidden="true" tabindex="-1"></a><span class="co"># basic bootstrap.</span></span>
<span id="cb34-47"><a href="#cb34-47" aria-hidden="true" tabindex="-1"></a>qs.mu.hats.b <span class="ot">=</span> <span class="fu">quantile</span>(<span class="at">x =</span> mu.hats.b, <span class="at">probs =</span> probs)</span>
<span id="cb34-48"><a href="#cb34-48" aria-hidden="true" tabindex="-1"></a>ci.basic <span class="ot">=</span> <span class="fu">setCINames</span>(<span class="dv">2</span><span class="sc">*</span>mu.hat <span class="sc">-</span> <span class="fu">rev</span>(qs.mu.hats.b))</span>
<span id="cb34-49"><a href="#cb34-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-50"><a href="#cb34-50" aria-hidden="true" tabindex="-1"></a><span class="co"># percentile.</span></span>
<span id="cb34-51"><a href="#cb34-51" aria-hidden="true" tabindex="-1"></a>ci.percentile <span class="ot">=</span> <span class="fu">setCINames</span>(<span class="fu">quantile</span>(mu.hats.b, <span class="at">probs =</span> probs))</span>
<span id="cb34-52"><a href="#cb34-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-53"><a href="#cb34-53" aria-hidden="true" tabindex="-1"></a><span class="co"># set up data for the MC study.</span></span>
<span id="cb34-54"><a href="#cb34-54" aria-hidden="true" tabindex="-1"></a>mc.study <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="fu">rbind</span>(ci.sn, ci.basic, ci.percentile))</span>
<span id="cb34-55"><a href="#cb34-55" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(mc.study) <span class="ot">=</span> names</span>
<span id="cb34-56"><a href="#cb34-56" aria-hidden="true" tabindex="-1"></a>mc.study[<span class="st">&#39;miss.left&#39;</span>] <span class="ot">=</span> <span class="fu">rep.int</span>(<span class="dv">0</span>, <span class="at">times =</span> <span class="fu">nrow</span>(mc.study))</span>
<span id="cb34-57"><a href="#cb34-57" aria-hidden="true" tabindex="-1"></a>mc.study[<span class="st">&#39;miss.right&#39;</span>] <span class="ot">=</span> <span class="fu">rep.int</span>(<span class="dv">0</span>, <span class="at">times =</span> <span class="fu">nrow</span>(mc.study))</span>
<span id="cb34-58"><a href="#cb34-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-59"><a href="#cb34-59" aria-hidden="true" tabindex="-1"></a><span class="co"># compute coverage rates for sample mean when sampling from the normal population xs.</span></span>
<span id="cb34-60"><a href="#cb34-60" aria-hidden="true" tabindex="-1"></a>size <span class="ot">=</span> n</span>
<span id="cb34-61"><a href="#cb34-61" aria-hidden="true" tabindex="-1"></a>rep <span class="ot">=</span> <span class="dv">10000</span></span>
<span id="cb34-62"><a href="#cb34-62" aria-hidden="true" tabindex="-1"></a>miss.l <span class="ot">=</span> <span class="dv">0</span></span>
<span id="cb34-63"><a href="#cb34-63" aria-hidden="true" tabindex="-1"></a>miss.r <span class="ot">=</span> <span class="dv">0</span></span>
<span id="cb34-64"><a href="#cb34-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-65"><a href="#cb34-65" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(r <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>rep) {</span>
<span id="cb34-66"><a href="#cb34-66" aria-hidden="true" tabindex="-1"></a>  i <span class="ot">=</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span>n, size, <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb34-67"><a href="#cb34-67" aria-hidden="true" tabindex="-1"></a>  mu.sample <span class="ot">=</span> <span class="fu">mean</span> (xs[i])</span>
<span id="cb34-68"><a href="#cb34-68" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(y <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(mc.study)) {</span>
<span id="cb34-69"><a href="#cb34-69" aria-hidden="true" tabindex="-1"></a>    lower <span class="ot">=</span> mc.study[y,names[<span class="dv">1</span>]]</span>
<span id="cb34-70"><a href="#cb34-70" aria-hidden="true" tabindex="-1"></a>    upper <span class="ot">=</span> mc.study[y,names[<span class="dv">2</span>]]</span>
<span id="cb34-71"><a href="#cb34-71" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (mu.sample <span class="sc">&lt;</span> lower) {</span>
<span id="cb34-72"><a href="#cb34-72" aria-hidden="true" tabindex="-1"></a>      mc.study[y,<span class="st">&#39;miss.left&#39;</span>] <span class="ot">=</span> mc.study[y,<span class="st">&#39;miss.left&#39;</span>] <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb34-73"><a href="#cb34-73" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> <span class="cf">if</span> (mu.sample <span class="sc">&gt;</span> upper) {</span>
<span id="cb34-74"><a href="#cb34-74" aria-hidden="true" tabindex="-1"></a>      mc.study[y,<span class="st">&#39;miss.right&#39;</span>] <span class="ot">=</span> mc.study[y,<span class="st">&#39;miss.right&#39;</span>] <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb34-75"><a href="#cb34-75" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb34-76"><a href="#cb34-76" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb34-77"><a href="#cb34-77" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb34-78"><a href="#cb34-78" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-79"><a href="#cb34-79" aria-hidden="true" tabindex="-1"></a>mc.study<span class="sc">$</span>miss.left <span class="ot">=</span> mc.study<span class="sc">$</span>miss.left<span class="sc">/</span>rep</span>
<span id="cb34-80"><a href="#cb34-80" aria-hidden="true" tabindex="-1"></a>mc.study<span class="sc">$</span>miss.right <span class="ot">=</span> mc.study<span class="sc">$</span>miss.right<span class="sc">/</span>rep</span>
<span id="cb34-81"><a href="#cb34-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-82"><a href="#cb34-82" aria-hidden="true" tabindex="-1"></a>mc.study</span></code></pre></div>
<pre><code>##                   2.5%    97.5% miss.left miss.right
## ci.sn         3.965585 4.031373    0.0293     0.0285
## ci.basic      3.962652 4.030463    0.0182     0.0321
## ci.percentile 3.966495 4.034306    0.0344     0.0197</code></pre>
<p>We can see from the result that the intervals of three method are very close to each other. But there are still some slight differences between the results of three methods. Using basic methods, the interval tend to cover larger numbers. And using percentile method, the interval tend to cover smaller numbers.</p>
</div>
</div>
</div>
</div>
<div id="section-19" class="section level1">
<h1>2022-10-21</h1>
<div id="question-6" class="section level2">
<h2>Question</h2>
<ul>
<li>Exercises 7.8, 7.11, 8.2(pages 212-213, 242, Statistical Computating with R)</li>
</ul>
</div>
<div id="answer-6" class="section level2">
<h2>Answer</h2>
<div id="section-20" class="section level3">
<h3>7.8</h3>
<div id="rfer-to-excercise-7.6-the-five-dimensional-scores-data-have-a-5-times-5-covariance-matrix-sigma-with-positive-eigenvalues-lambda_1cdot-cdot-cdotlambda_5.-in-principal-components-analysis-thetafraclambda_1sum_j15lambda_j-measures-the-proportion-of-variance-explained-by-the-first-principal-component.-let-hatlambda_1cdot-cdot-cdothatlambda_5-be-the-eigenvalues-of-hatsigma-where-hatsigma-is-the-mle-of-sigma.compute-the-sample-estimate-hatthetafrachatlambda_1sum_j15hatlambda_jobtain-the-jackknife-estimates-of-bias-and-standard-error-of-hattheta." class="section level4">
<h4>Rfer to Excercise 7.6, the five-dimensional scores data have a 5 <span class="math inline">\(\times\)</span> 5 covariance matrix <span class="math inline">\(\Sigma\)</span>, with positive eigenvalues <span class="math inline">\(\lambda_1&gt;\cdot \cdot \cdot&gt;\lambda_5\)</span>. In principal components analysis, <span class="math display">\[\theta=\frac{\lambda_1}{\sum_{j=1}^{5}\lambda_j}\]</span> measures the proportion of variance explained by the first principal component. Let <span class="math inline">\(\hat{\lambda}_1&gt;\cdot \cdot \cdot|\hat{\lambda}_5\)</span> be the eigenvalues of <span class="math inline">\(\hat{\Sigma}\)</span>, where <span class="math inline">\(\hat{\Sigma}\)</span> is the MLE of <span class="math inline">\(\Sigma\)</span>.Compute the sample estimate <span class="math display">\[\hat{\theta}=\frac{\hat{\lambda}_1}{\sum_{j=1}^{5}\hat{\lambda}_j}\]</span>Obtain the jackknife estimates of bias and standard error of <span class="math inline">\(\hat{\theta}\)</span>.</h4>
<p>It’s obvious that Jackknife is a special case of bootstrap with the help of leave one out principle. So we just need to leave one sample at each time to obtain the estimate.</p>
<p>Let <span class="math inline">\(\frac{\partial L(\lambda)}{\partial \lambda}=0\)</span>, we can obtain the MLE of <span class="math inline">\(\lambda\)</span>: <span class="math display">\[\hat{\lambda}_{MLE}=\overline{X}\]</span></p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(bootstrap)</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>Excercise_7_8 <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">seed=</span><span class="dv">1012</span>){</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>sc <span class="ot">&lt;-</span> scor</span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(seed)</span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a>theta <span class="ot">&lt;-</span> <span class="cf">function</span>(x){ </span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a>  sigma <span class="ot">&lt;-</span> <span class="fu">cov</span>(x)</span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a>  pca.sigma <span class="ot">&lt;-</span> <span class="fu">prcomp</span>(sigma) </span>
<span id="cb36-9"><a href="#cb36-9" aria-hidden="true" tabindex="-1"></a>  theta <span class="ot">&lt;-</span> pca.sigma<span class="sc">$</span>sdev[<span class="dv">1</span>] <span class="sc">/</span> <span class="fu">sum</span>(pca.sigma<span class="sc">$</span>sdev) </span>
<span id="cb36-10"><a href="#cb36-10" aria-hidden="true" tabindex="-1"></a>  theta</span>
<span id="cb36-11"><a href="#cb36-11" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb36-12"><a href="#cb36-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-13"><a href="#cb36-13" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">NROW</span>(sc)</span>
<span id="cb36-14"><a href="#cb36-14" aria-hidden="true" tabindex="-1"></a>theta.j<span class="ot">&lt;-</span> <span class="fu">numeric</span>(n)</span>
<span id="cb36-15"><a href="#cb36-15" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n){    </span>
<span id="cb36-16"><a href="#cb36-16" aria-hidden="true" tabindex="-1"></a>  theta.j[i] <span class="ot">&lt;-</span> <span class="fu">theta</span>(sc[<span class="sc">-</span>i,])</span>
<span id="cb36-17"><a href="#cb36-17" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb36-18"><a href="#cb36-18" aria-hidden="true" tabindex="-1"></a>theta.hat <span class="ot">&lt;-</span> <span class="fu">theta</span>(sc)</span>
<span id="cb36-19"><a href="#cb36-19" aria-hidden="true" tabindex="-1"></a>bias <span class="ot">&lt;-</span> (n<span class="dv">-1</span>) <span class="sc">*</span> (<span class="fu">mean</span>(theta.j) <span class="sc">-</span> theta.hat) <span class="co">#BIAS</span></span>
<span id="cb36-20"><a href="#cb36-20" aria-hidden="true" tabindex="-1"></a>se <span class="ot">&lt;-</span> <span class="fu">sqrt</span>((n<span class="dv">-1</span>)<span class="sc">*</span><span class="fu">var</span>(theta.j)) <span class="co">#SE</span></span>
<span id="cb36-21"><a href="#cb36-21" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">c</span>(bias,se),<span class="dv">3</span>)</span>
<span id="cb36-22"><a href="#cb36-22" aria-hidden="true" tabindex="-1"></a><span class="fu">return</span>(<span class="fu">list</span>(<span class="at">Bias.jack=</span>bias,<span class="at">SE.jack=</span>se))</span>
<span id="cb36-23"><a href="#cb36-23" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb36-24"><a href="#cb36-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-25"><a href="#cb36-25" aria-hidden="true" tabindex="-1"></a><span class="fu">Excercise_7_8</span>()</span></code></pre></div>
<pre><code>## $Bias.jack
## [1] 0.01433958
## 
## $SE.jack
## [1] 0.05299504</code></pre>
</div>
</div>
<div id="section-21" class="section level3">
<h3>7.11</h3>
<div id="in-example-7.18-leave-one-outn-foldcross-validation-was-used-to-select-the-best-fitting-model.-use-leave-two-out-cross-validation-to-compare-the-models." class="section level4">
<h4>In Example 7.18, leave-one-out(n-fold)cross validation was used to select the best fitting model. Use leave-two-out cross validation to compare the models.</h4>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(DAAG)</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a><span class="fu">attach</span>(ironslag)</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">length</span>(magnetic)</span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="fu">choose</span>(n,<span class="dv">2</span>)</span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a>e1 <span class="ot">&lt;-</span> e2 <span class="ot">&lt;-</span> e3 <span class="ot">&lt;-</span> e4 <span class="ot">&lt;-</span> e5 <span class="ot">&lt;-</span> <span class="fu">numeric</span>(N)</span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a>index <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb38-9"><a href="#cb38-9" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>(n<span class="dv">-1</span>)) <span class="cf">for</span>(j <span class="cf">in</span> (i<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>n) {</span>
<span id="cb38-10"><a href="#cb38-10" aria-hidden="true" tabindex="-1"></a>  leave <span class="ot">&lt;-</span> <span class="fu">c</span>(i, j)</span>
<span id="cb38-11"><a href="#cb38-11" aria-hidden="true" tabindex="-1"></a>  y <span class="ot">&lt;-</span> magnetic[<span class="sc">-</span>leave]</span>
<span id="cb38-12"><a href="#cb38-12" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> chemical[<span class="sc">-</span>leave]</span>
<span id="cb38-13"><a href="#cb38-13" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb38-14"><a href="#cb38-14" aria-hidden="true" tabindex="-1"></a>  J1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x)</span>
<span id="cb38-15"><a href="#cb38-15" aria-hidden="true" tabindex="-1"></a>  yhat1 <span class="ot">&lt;-</span> J1<span class="sc">$</span>coefficients[<span class="dv">1</span>] <span class="sc">+</span> J1<span class="sc">$</span>coefficients[<span class="dv">2</span>] <span class="sc">*</span> chemical[leave]</span>
<span id="cb38-16"><a href="#cb38-16" aria-hidden="true" tabindex="-1"></a>  e1[index] <span class="ot">&lt;-</span> <span class="fu">sum</span>((magnetic[leave] <span class="sc">-</span> yhat1)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb38-17"><a href="#cb38-17" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb38-18"><a href="#cb38-18" aria-hidden="true" tabindex="-1"></a>  J2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x <span class="sc">+</span> <span class="fu">I</span>(x<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb38-19"><a href="#cb38-19" aria-hidden="true" tabindex="-1"></a>  yhat2 <span class="ot">&lt;-</span> J2<span class="sc">$</span>coefficients[<span class="dv">1</span>] <span class="sc">+</span> J2<span class="sc">$</span>coefficients[<span class="dv">2</span>] <span class="sc">*</span> chemical[leave] <span class="sc">+</span> </span>
<span id="cb38-20"><a href="#cb38-20" aria-hidden="true" tabindex="-1"></a>    J2<span class="sc">$</span>coefficients[<span class="dv">3</span>] <span class="sc">*</span> chemical[leave] <span class="sc">^</span> <span class="dv">2</span></span>
<span id="cb38-21"><a href="#cb38-21" aria-hidden="true" tabindex="-1"></a>  e2[index] <span class="ot">&lt;-</span> <span class="fu">sum</span>((magnetic[leave] <span class="sc">-</span> yhat2)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb38-22"><a href="#cb38-22" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb38-23"><a href="#cb38-23" aria-hidden="true" tabindex="-1"></a>  J3 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">log</span>(y) <span class="sc">~</span> x)</span>
<span id="cb38-24"><a href="#cb38-24" aria-hidden="true" tabindex="-1"></a>  yhat3 <span class="ot">&lt;-</span> <span class="fu">exp</span>(J3<span class="sc">$</span>coefficients[<span class="dv">1</span>] <span class="sc">+</span> J3<span class="sc">$</span>coefficients[<span class="dv">2</span>] <span class="sc">*</span> chemical[leave])</span>
<span id="cb38-25"><a href="#cb38-25" aria-hidden="true" tabindex="-1"></a>  e3[index] <span class="ot">&lt;-</span> <span class="fu">sum</span>((magnetic[leave] <span class="sc">-</span> yhat3)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb38-26"><a href="#cb38-26" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb38-27"><a href="#cb38-27" aria-hidden="true" tabindex="-1"></a>  J4 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">log</span>(y) <span class="sc">~</span> <span class="fu">log</span>(x))</span>
<span id="cb38-28"><a href="#cb38-28" aria-hidden="true" tabindex="-1"></a>  yhat4 <span class="ot">&lt;-</span> <span class="fu">exp</span>(J4<span class="sc">$</span>coefficients[<span class="dv">1</span>] <span class="sc">+</span> J4<span class="sc">$</span>coefficients[<span class="dv">2</span>] <span class="sc">*</span> <span class="fu">log</span>(chemical[leave]))</span>
<span id="cb38-29"><a href="#cb38-29" aria-hidden="true" tabindex="-1"></a>  e4[index] <span class="ot">&lt;-</span> <span class="fu">sum</span>((magnetic[leave] <span class="sc">-</span> yhat4)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb38-30"><a href="#cb38-30" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb38-31"><a href="#cb38-31" aria-hidden="true" tabindex="-1"></a>  x2 <span class="ot">&lt;-</span> x<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb38-32"><a href="#cb38-32" aria-hidden="true" tabindex="-1"></a>  x3 <span class="ot">&lt;-</span> x<span class="sc">^</span><span class="dv">3</span></span>
<span id="cb38-33"><a href="#cb38-33" aria-hidden="true" tabindex="-1"></a>  J5 <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x <span class="sc">+</span> x2 <span class="sc">+</span> x3)</span>
<span id="cb38-34"><a href="#cb38-34" aria-hidden="true" tabindex="-1"></a>  yhat5 <span class="ot">&lt;-</span> J5<span class="sc">$</span>coefficients[<span class="dv">1</span>] <span class="sc">+</span> J5<span class="sc">$</span>coefficients[<span class="dv">2</span>] <span class="sc">*</span> chemical[leave] <span class="sc">+</span> </span>
<span id="cb38-35"><a href="#cb38-35" aria-hidden="true" tabindex="-1"></a>    J5<span class="sc">$</span>coefficients[<span class="dv">3</span>] <span class="sc">*</span> chemical[leave] <span class="sc">^</span> <span class="dv">2</span> <span class="sc">+</span> </span>
<span id="cb38-36"><a href="#cb38-36" aria-hidden="true" tabindex="-1"></a>    J5<span class="sc">$</span>coefficients[<span class="dv">4</span>] <span class="sc">*</span> chemical[leave] <span class="sc">^</span> <span class="dv">3</span></span>
<span id="cb38-37"><a href="#cb38-37" aria-hidden="true" tabindex="-1"></a>  e5[index] <span class="ot">&lt;-</span> <span class="fu">sum</span>((magnetic[leave] <span class="sc">-</span> yhat5)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb38-38"><a href="#cb38-38" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb38-39"><a href="#cb38-39" aria-hidden="true" tabindex="-1"></a>  index <span class="ot">&lt;-</span> index <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb38-40"><a href="#cb38-40" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb38-41"><a href="#cb38-41" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">c</span>(<span class="fu">mean</span>(e1), <span class="fu">mean</span>(e2), <span class="fu">mean</span>(e3), <span class="fu">mean</span>(e4), <span class="fu">mean</span>(e5)))</span></code></pre></div>
<pre><code>## [1] 39.14455 35.74037 36.90983 40.93436 36.46996</code></pre>
<p>From the result, we can easily see that Model 2, the quadratic model, would be the best fit for the data.</p>
</div>
</div>
<div id="section-22" class="section level3">
<h3>8.2</h3>
<div id="implement-the-bivariate-spearman-rank-correlation-test-for-independence-as-a-permutation-test.-the-spearman-rank-correlation-test-statistic-can-be-obtained-from-function-cor-with-methodspearman.-compare-the-achieved-signifivance-level-of-the-permutation-test-with-the-p-value-reported-by-cor.test-on-the-same-sample." class="section level4">
<h4>Implement the bivariate Spearman rank correlation test for independence as a permutation test. The Spearman rank correlation test statistic can be obtained from function cor with method=“spearman”. Compare the achieved signifivance level of the permutation test with the p-value reported by cor.test on the same sample.</h4>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>Excercise_8_2 <span class="ot">&lt;-</span> <span class="cf">function</span>(){</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>  Spearman_rank_test <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y, <span class="at">B =</span> <span class="fl">1e4</span>){</span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>    t0 <span class="ot">=</span> <span class="fu">cor</span>(x,y,<span class="at">method =</span> <span class="st">&quot;spearman&quot;</span>)</span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>    perm <span class="ot">=</span> <span class="fu">numeric</span>(B)</span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>    z <span class="ot">=</span> <span class="fu">c</span>(x,y)</span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>B){</span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a>      samp <span class="ot">=</span> <span class="fu">sample</span>(z)</span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a>      perm[i] <span class="ot">=</span> <span class="fu">cor</span>(samp[<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(x)], samp[(<span class="fu">length</span>(x)<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span><span class="fu">length</span>(z)], <span class="at">method =</span> <span class="st">&quot;spearman&quot;</span>)</span>
<span id="cb40-9"><a href="#cb40-9" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb40-10"><a href="#cb40-10" aria-hidden="true" tabindex="-1"></a>    p_value <span class="ot">=</span> <span class="fu">mean</span>(<span class="fu">abs</span>(perm)<span class="sc">&gt;=</span><span class="fu">abs</span>(t0))</span>
<span id="cb40-11"><a href="#cb40-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">statistic =</span> t0, <span class="st">&#39;p.value&#39;</span> <span class="ot">=</span> p_value))</span>
<span id="cb40-12"><a href="#cb40-12" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb40-13"><a href="#cb40-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="st">&#39;When x and y are independent:&#39;</span>)</span>
<span id="cb40-14"><a href="#cb40-14" aria-hidden="true" tabindex="-1"></a>  n <span class="ot">=</span> <span class="dv">1000</span></span>
<span id="cb40-15"><a href="#cb40-15" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">=</span> <span class="fu">rnorm</span>(n, <span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb40-16"><a href="#cb40-16" aria-hidden="true" tabindex="-1"></a>  y <span class="ot">=</span> <span class="fu">rnorm</span>(n, <span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb40-17"><a href="#cb40-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">Spearman_rank_test</span>(x, y))</span>
<span id="cb40-18"><a href="#cb40-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">cor.test</span>(x, y, <span class="at">method =</span> <span class="st">&quot;spearman&quot;</span>))</span>
<span id="cb40-19"><a href="#cb40-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="st">&#39;When x and y are dependent:&#39;</span>)</span>
<span id="cb40-20"><a href="#cb40-20" aria-hidden="true" tabindex="-1"></a>  n <span class="ot">=</span> <span class="dv">1000</span></span>
<span id="cb40-21"><a href="#cb40-21" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">=</span> <span class="fu">rnorm</span>(n, <span class="dv">5</span>, <span class="dv">4</span>)</span>
<span id="cb40-22"><a href="#cb40-22" aria-hidden="true" tabindex="-1"></a>  y <span class="ot">=</span> x <span class="sc">+</span> <span class="fu">rnorm</span>(n, <span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb40-23"><a href="#cb40-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">Spearman_rank_test</span>(x, y))</span>
<span id="cb40-24"><a href="#cb40-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">cor.test</span>(x, y, <span class="at">method =</span> <span class="st">&quot;spearman&quot;</span>))</span>
<span id="cb40-25"><a href="#cb40-25" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb40-26"><a href="#cb40-26" aria-hidden="true" tabindex="-1"></a><span class="fu">Excercise_8_2</span>()</span></code></pre></div>
<pre><code>## [1] &quot;When x and y are independent:&quot;
## $statistic
## [1] 0.0566079
## 
## $p.value
## [1] 0.0731
## 
## 
##  Spearman&#39;s rank correlation rho
## 
## data:  x and y
## S = 157231860, p-value = 0.07357
## alternative hypothesis: true rho is not equal to 0
## sample estimates:
##       rho 
## 0.0566079 
## 
## [1] &quot;When x and y are dependent:&quot;
## $statistic
## [1] 0.9707557
## 
## $p.value
## [1] 0
## 
## 
##  Spearman&#39;s rank correlation rho
## 
## data:  x and y
## S = 4874046, p-value &lt; 2.2e-16
## alternative hypothesis: true rho is not equal to 0
## sample estimates:
##       rho 
## 0.9707557</code></pre>
<p>We can see from the result that the p-value calculated by two method are very close to each other in both independent case and dependent case. And in independent case, the p-values are large that we cannot reject the null hypothesis, which means two samples are independent. And in dependent case, the p-values are very close to 0, so we reject the null hypothesis. So using two methods can figure out whether two samples are independent.</p>
</div>
</div>
</div>
</div>
<div id="section-23" class="section level1">
<h1>2022-10-28</h1>
<div id="question-7" class="section level2">
<h2>Question</h2>
<ul>
<li>Exercises 9.4, 9.7(pages 212-213, 242, Statistical Computating with R)</li>
</ul>
<p>For each of the above exercise, use the Gelman-Rubin method to monitor convergence of the chain, and run the chain until it converges approximately to the target distribution according to <span class="math inline">\(\hat{R}&lt;1.2\)</span>.</p>
</div>
<div id="answer-7" class="section level2">
<h2>Answer</h2>
<div id="section-24" class="section level3">
<h3>9.4</h3>
<div id="implement-a-random-walk-metropolis-sampler-for-generating-the-standard-laplace-distribution.-dor-the-increment-simulate-from-a-normal-distribution.-compare-the-chains-generated-when-different-variances-are-used-for-the-proposal-distribution.-also-compute-the-acceptance-rates-of-each-chain-and-use-the-gelman-rubin-method-to-monitor-convergence-of-the-chain." class="section level4">
<h4>Implement a random walk Metropolis sampler for generating the standard Laplace distribution. Dor the increment, simulate from a normal distribution. Compare the chains generated when different variances are used for the proposal distribution. Also compute the acceptance rates of each chain and use the Gelman-Rubin method to monitor convergence of the chain.</h4>
<ul>
<li>First of all, we implement a random walk Metropolis sampler for generating the standard Laplace distribution. In this question we generate 10000 samples for each variance.</li>
</ul>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>sds <span class="ot">=</span> <span class="fu">c</span>(<span class="fl">0.5</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">25</span>, <span class="dv">100</span>)</span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>exercise_9<span class="fl">.4</span> <span class="ot">&lt;-</span> <span class="cf">function</span> (sd) {</span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a>  N <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a>  <span class="co"># standard laplace distribution.</span></span>
<span id="cb42-8"><a href="#cb42-8" aria-hidden="true" tabindex="-1"></a>  df <span class="ot">&lt;-</span> <span class="cf">function</span> (x) {</span>
<span id="cb42-9"><a href="#cb42-9" aria-hidden="true" tabindex="-1"></a>    <span class="dv">1</span><span class="sc">/</span><span class="dv">2</span> <span class="sc">*</span> <span class="fu">exp</span>(<span class="sc">-</span><span class="fu">abs</span>(x))</span>
<span id="cb42-10"><a href="#cb42-10" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb42-11"><a href="#cb42-11" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb42-12"><a href="#cb42-12" aria-hidden="true" tabindex="-1"></a>  rg <span class="ot">=</span> <span class="cf">function</span> (mean, sd) {</span>
<span id="cb42-13"><a href="#cb42-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rnorm</span>(<span class="at">n =</span> <span class="dv">1</span>, <span class="at">mean =</span> mean, <span class="at">sd =</span> sd)</span>
<span id="cb42-14"><a href="#cb42-14" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb42-15"><a href="#cb42-15" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb42-16"><a href="#cb42-16" aria-hidden="true" tabindex="-1"></a>  rw <span class="ot">=</span> <span class="cf">function</span> (N, df, rg) {</span>
<span id="cb42-17"><a href="#cb42-17" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb42-18"><a href="#cb42-18" aria-hidden="true" tabindex="-1"></a>    x <span class="ot">=</span> <span class="fu">numeric</span>(N)</span>
<span id="cb42-19"><a href="#cb42-19" aria-hidden="true" tabindex="-1"></a>    x[<span class="dv">1</span>] <span class="ot">=</span> <span class="fu">rg</span>(<span class="dv">0</span>, sd)</span>
<span id="cb42-20"><a href="#cb42-20" aria-hidden="true" tabindex="-1"></a>    k <span class="ot">=</span> <span class="dv">0</span></span>
<span id="cb42-21"><a href="#cb42-21" aria-hidden="true" tabindex="-1"></a>    us <span class="ot">=</span> <span class="fu">runif</span>(N)</span>
<span id="cb42-22"><a href="#cb42-22" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb42-23"><a href="#cb42-23" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>N) {</span>
<span id="cb42-24"><a href="#cb42-24" aria-hidden="true" tabindex="-1"></a>      xt <span class="ot">=</span> x[i<span class="dv">-1</span>]</span>
<span id="cb42-25"><a href="#cb42-25" aria-hidden="true" tabindex="-1"></a>      y <span class="ot">=</span> <span class="fu">rg</span>(xt, sd)</span>
<span id="cb42-26"><a href="#cb42-26" aria-hidden="true" tabindex="-1"></a>      res <span class="ot">=</span> <span class="fu">df</span>(y) <span class="sc">/</span> <span class="fu">df</span>(xt)</span>
<span id="cb42-27"><a href="#cb42-27" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (us[i] <span class="sc">&lt;=</span> res) {</span>
<span id="cb42-28"><a href="#cb42-28" aria-hidden="true" tabindex="-1"></a>        x[i] <span class="ot">=</span> y</span>
<span id="cb42-29"><a href="#cb42-29" aria-hidden="true" tabindex="-1"></a>        k <span class="ot">=</span> k <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb42-30"><a href="#cb42-30" aria-hidden="true" tabindex="-1"></a>      } <span class="cf">else</span> {</span>
<span id="cb42-31"><a href="#cb42-31" aria-hidden="true" tabindex="-1"></a>        x[i] <span class="ot">=</span> xt</span>
<span id="cb42-32"><a href="#cb42-32" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb42-33"><a href="#cb42-33" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb42-34"><a href="#cb42-34" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">&#39;The acceptance rates is: &#39;</span>, k<span class="sc">/</span>N, <span class="st">&#39; (sd=&#39;</span>, sd, <span class="st">&#39;)&#39;</span>))</span>
<span id="cb42-35"><a href="#cb42-35" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(x)</span>
<span id="cb42-36"><a href="#cb42-36" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb42-37"><a href="#cb42-37" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">rw</span>(N, df, rg)</span>
<span id="cb42-38"><a href="#cb42-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(x)</span>
<span id="cb42-39"><a href="#cb42-39" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb42-40"><a href="#cb42-40" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow=</span><span class="fu">length</span>(sds), <span class="at">ncol=</span><span class="dv">10000</span>)</span>
<span id="cb42-41"><a href="#cb42-41" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(sds))</span>
<span id="cb42-42"><a href="#cb42-42" aria-hidden="true" tabindex="-1"></a>    X[i, ] <span class="ot">&lt;-</span> <span class="fu">exercise_9.4</span>(sds[i])</span></code></pre></div>
<pre><code>## [1] &quot;The acceptance rates is: 0.8308 (sd=0.5)&quot;
## [1] &quot;The acceptance rates is: 0.6907 (sd=1)&quot;
## [1] &quot;The acceptance rates is: 0.5163 (sd=2)&quot;
## [1] &quot;The acceptance rates is: 0.3339 (sd=4)&quot;
## [1] &quot;The acceptance rates is: 0.0697 (sd=25)&quot;
## [1] &quot;The acceptance rates is: 0.017 (sd=100)&quot;</code></pre>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="co"># par(mfrow = c(3,2))</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a><span class="co"># plot(1:ncol(X), X[1,], type=&quot;l&quot;, ylab = paste(&quot;sd = &quot;, sds[1], sep = &#39;&#39;))</span></span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a><span class="co"># for (i in 2:length(sds)) {</span></span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a><span class="co">#   plot(1:ncol(X), X[i,], type=&quot;l&quot;, ylab = paste(&quot;sd = &quot;, sds[i], sep = &#39;&#39;), col=i)</span></span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a><span class="co"># }</span></span></code></pre></div>
<p>From the result above, we can easily know that with the increase of sd, the acceptance rate become smaller and the figure seems more sparse.</p>
<ul>
<li>And then we follow the text book to construct the Gelman-Rubin method. So the scalar summary statistic <span class="math inline">\(\psi_{ij}\)</span> is the mean of the <span class="math inline">\(i^{th}\)</span> chain up to time <span class="math inline">\(j\)</span>. We do not set the simulation numbers this time, the simulation will stop until it converge.</li>
</ul>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>Gelman.Rubin <span class="ot">&lt;-</span> <span class="cf">function</span>(psi) {</span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>        <span class="co"># psi[i,j] is the statistic psi(X[i,1:j])</span></span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>        <span class="co"># for chain in i-th row of X</span></span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a>        psi <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(psi)</span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a>        n <span class="ot">&lt;-</span> <span class="fu">ncol</span>(psi)</span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a>        k <span class="ot">&lt;-</span> <span class="fu">nrow</span>(psi)</span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-8"><a href="#cb45-8" aria-hidden="true" tabindex="-1"></a>        psi.means <span class="ot">&lt;-</span> <span class="fu">rowMeans</span>(psi)     <span class="co">#row means</span></span>
<span id="cb45-9"><a href="#cb45-9" aria-hidden="true" tabindex="-1"></a>        B <span class="ot">&lt;-</span> n <span class="sc">*</span> <span class="fu">var</span>(psi.means)        <span class="co">#between variance est.</span></span>
<span id="cb45-10"><a href="#cb45-10" aria-hidden="true" tabindex="-1"></a>        psi.w <span class="ot">&lt;-</span> <span class="fu">apply</span>(psi, <span class="dv">1</span>, <span class="st">&quot;var&quot;</span>)  <span class="co">#within variances</span></span>
<span id="cb45-11"><a href="#cb45-11" aria-hidden="true" tabindex="-1"></a>        W <span class="ot">&lt;-</span> <span class="fu">mean</span>(psi.w)               <span class="co">#within est.</span></span>
<span id="cb45-12"><a href="#cb45-12" aria-hidden="true" tabindex="-1"></a>        v.hat <span class="ot">&lt;-</span> W<span class="sc">*</span>(n<span class="dv">-1</span>)<span class="sc">/</span>n <span class="sc">+</span> (B<span class="sc">/</span>n)     <span class="co">#upper variance est.</span></span>
<span id="cb45-13"><a href="#cb45-13" aria-hidden="true" tabindex="-1"></a>        r.hat <span class="ot">&lt;-</span> v.hat <span class="sc">/</span> W             <span class="co">#G-R statistic</span></span>
<span id="cb45-14"><a href="#cb45-14" aria-hidden="true" tabindex="-1"></a>        <span class="fu">return</span>(r.hat)</span>
<span id="cb45-15"><a href="#cb45-15" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb45-16"><a href="#cb45-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-17"><a href="#cb45-17" aria-hidden="true" tabindex="-1"></a>sds <span class="ot">=</span> <span class="fu">c</span>(<span class="fl">0.5</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">25</span>, <span class="dv">100</span>)</span>
<span id="cb45-18"><a href="#cb45-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-19"><a href="#cb45-19" aria-hidden="true" tabindex="-1"></a>exercise_9<span class="fl">.4</span>_1 <span class="ot">&lt;-</span> <span class="cf">function</span> (sds) {</span>
<span id="cb45-20"><a href="#cb45-20" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb45-21"><a href="#cb45-21" aria-hidden="true" tabindex="-1"></a>  <span class="co"># standard laplace distribution.</span></span>
<span id="cb45-22"><a href="#cb45-22" aria-hidden="true" tabindex="-1"></a>  df <span class="ot">&lt;-</span> <span class="cf">function</span> (x) {</span>
<span id="cb45-23"><a href="#cb45-23" aria-hidden="true" tabindex="-1"></a>    <span class="dv">1</span><span class="sc">/</span><span class="dv">2</span> <span class="sc">*</span> <span class="fu">exp</span>(<span class="sc">-</span><span class="fu">abs</span>(x))</span>
<span id="cb45-24"><a href="#cb45-24" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb45-25"><a href="#cb45-25" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb45-26"><a href="#cb45-26" aria-hidden="true" tabindex="-1"></a>  rg <span class="ot">=</span> <span class="cf">function</span> (mean, sd) {</span>
<span id="cb45-27"><a href="#cb45-27" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rnorm</span>(<span class="at">n =</span> <span class="dv">1</span>, <span class="at">mean =</span> mean, <span class="at">sd =</span> sd)</span>
<span id="cb45-28"><a href="#cb45-28" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb45-29"><a href="#cb45-29" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb45-30"><a href="#cb45-30" aria-hidden="true" tabindex="-1"></a>  k <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb45-31"><a href="#cb45-31" aria-hidden="true" tabindex="-1"></a>  acc_rate <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb45-32"><a href="#cb45-32" aria-hidden="true" tabindex="-1"></a>  r_hat <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb45-33"><a href="#cb45-33" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>,<span class="at">nrow =</span> <span class="fu">length</span>(sds), <span class="at">ncol =</span> <span class="dv">1</span>)</span>
<span id="cb45-34"><a href="#cb45-34" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(sds)) {</span>
<span id="cb45-35"><a href="#cb45-35" aria-hidden="true" tabindex="-1"></a>    x[i,<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">rg</span>(<span class="dv">0</span>, sds[i])</span>
<span id="cb45-36"><a href="#cb45-36" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb45-37"><a href="#cb45-37" aria-hidden="true" tabindex="-1"></a>  psi <span class="ot">&lt;-</span> <span class="fu">t</span>(<span class="fu">apply</span>(x, <span class="dv">1</span>, cumsum))</span>
<span id="cb45-38"><a href="#cb45-38" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(psi)){</span>
<span id="cb45-39"><a href="#cb45-39" aria-hidden="true" tabindex="-1"></a>    psi[i,] <span class="ot">&lt;-</span> psi[i,] <span class="sc">/</span> (<span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(psi))</span>
<span id="cb45-40"><a href="#cb45-40" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb45-41"><a href="#cb45-41" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb45-42"><a href="#cb45-42" aria-hidden="true" tabindex="-1"></a>  <span class="cf">while</span> (k <span class="sc">==</span> <span class="dv">1</span> <span class="sc">|</span> <span class="fu">Gelman.Rubin</span>(psi) <span class="sc">&gt;=</span> <span class="fl">1.2</span>) {</span>
<span id="cb45-43"><a href="#cb45-43" aria-hidden="true" tabindex="-1"></a>    k <span class="ot">=</span> k <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb45-44"><a href="#cb45-44" aria-hidden="true" tabindex="-1"></a>    temp <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>,<span class="at">nrow =</span> <span class="fu">length</span>(sds), <span class="at">ncol =</span> <span class="dv">1</span>)</span>
<span id="cb45-45"><a href="#cb45-45" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(sds)) {</span>
<span id="cb45-46"><a href="#cb45-46" aria-hidden="true" tabindex="-1"></a>      xt <span class="ot">&lt;-</span> x[i,k<span class="dv">-1</span>]</span>
<span id="cb45-47"><a href="#cb45-47" aria-hidden="true" tabindex="-1"></a>      y <span class="ot">&lt;-</span> <span class="fu">rg</span>(xt, sds[i])</span>
<span id="cb45-48"><a href="#cb45-48" aria-hidden="true" tabindex="-1"></a>      res <span class="ot">=</span> <span class="fu">df</span>(y) <span class="sc">/</span> <span class="fu">df</span>(xt)</span>
<span id="cb45-49"><a href="#cb45-49" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (<span class="fu">runif</span>(<span class="dv">1</span>) <span class="sc">&lt;=</span> res) {</span>
<span id="cb45-50"><a href="#cb45-50" aria-hidden="true" tabindex="-1"></a>        temp[i,<span class="dv">1</span>] <span class="ot">=</span> y</span>
<span id="cb45-51"><a href="#cb45-51" aria-hidden="true" tabindex="-1"></a>      } <span class="cf">else</span> {</span>
<span id="cb45-52"><a href="#cb45-52" aria-hidden="true" tabindex="-1"></a>        temp[i,<span class="dv">1</span>] <span class="ot">=</span> xt</span>
<span id="cb45-53"><a href="#cb45-53" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb45-54"><a href="#cb45-54" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb45-55"><a href="#cb45-55" aria-hidden="true" tabindex="-1"></a>    x <span class="ot">&lt;-</span> <span class="fu">cbind</span>(x,temp)</span>
<span id="cb45-56"><a href="#cb45-56" aria-hidden="true" tabindex="-1"></a>    psi <span class="ot">&lt;-</span> <span class="fu">t</span>(<span class="fu">apply</span>(x, <span class="dv">1</span>, cumsum))</span>
<span id="cb45-57"><a href="#cb45-57" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(psi)){</span>
<span id="cb45-58"><a href="#cb45-58" aria-hidden="true" tabindex="-1"></a>      psi[i,] <span class="ot">&lt;-</span> psi[i,] <span class="sc">/</span> (<span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(psi))</span>
<span id="cb45-59"><a href="#cb45-59" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb45-60"><a href="#cb45-60" aria-hidden="true" tabindex="-1"></a>    r_hat[k<span class="dv">-1</span>] <span class="ot">&lt;-</span> <span class="fu">Gelman.Rubin</span>(psi)</span>
<span id="cb45-61"><a href="#cb45-61" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb45-62"><a href="#cb45-62" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(r_hat), r_hat[<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(r_hat)], <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">ylab =</span> <span class="st">&#39;R_hat&#39;</span>)</span>
<span id="cb45-63"><a href="#cb45-63" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(x)</span>
<span id="cb45-64"><a href="#cb45-64" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb45-65"><a href="#cb45-65" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">exercise_9.4_1</span>(sds)</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAZlBMVEUAAAAAADoAAGYAOjoAOpAAZrY6AAA6ADo6AGY6Ojo6kNtmAABmADpmkJBmtrZmtv+QOgCQOjqQkGaQtpCQ2/+2ZgC2tma225C2///bkDrbkJDb/7bb////tmb/25D//7b//9v////dCUVdAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAGrklEQVR4nO2dDXeiRhhGMY221bTabWiXdonm///JZWYARRkelDHAcO85e2Lw5SXeHebLAZJP6CQZ+w+YOggSIEiAIAGCBAgSIEiAIAGCBAgSIEiAIAGCBAgSIEiAIAGCBAgSIEiAIAGCBAgSIEiAIAGCBAgSIEiAIAGCBAgSIEiAIAGCBAgSIEiAIAGCBAgSIEiAIAGCBAgSIEiAIAGCBAgSIEiAIAGCBAgSIEiAIAGCBAgSIEiAIAGCBAgSIEiAIAGCBAgSIEiAIAGCBAgSIEiAIAGCBAgSIEiAIAGCBAgSIEiAIAGCBIEFJbNhLEFh0z0PBAkQJBhX0Aw0IUiAIMEXC7pqPREk0iFIpEOQSIcgkQ5BIh2CRDoEiXQIEukQJNIhSKRDkEi3XEGngxtxvXzvTLdYQVmydS/y6kV7uqUKOh1qLdnrj450SxV03O2rl7nnJFu2IEqQIkvKIkQd5OG4c62Yp/wgqGc6BN1kYU7akSbJ2nYW956AhQsybVearE1dRCXdgm3m89X7J818O7aj6LqIdBTboAQp6jrook/dlm6xghbdih3f3u1PX+1yT7qoBWUIagtMz31hT+1yT7oIBZ1LUIjjRiko5HHjFFRNZQSog2Zg6AFB6euPbP35sfG14Peki1GQGX/mRUfQ10e+K12cgvafH799t/8GHzdGQWb0YFoyBPkCTQ8x3XKK+QPTtWnJBjVicQsKeFwEXWe5ugwrSkFy5cYd6aIUlA6rfRrpYhTk/aLikePGKWjQGKOZLkZBp8M63HFjFDR0mNpIF52gaqqDVuzxwLvSRS7o9NfDs68I6pcOQSLdYgX1XEi+WEF9F5IvVVDvZcBLFdR7IflSBVGCSjrqoH4LyeMW9F/HUKPnQvIYBWVl2306MBZrCzQrD9OiXOSPLX+Jfk7aTgYVjVSWrHp0ojsmRmIVZOdbT4ffk85Jsx6TIvEKMmUiVadX2XgtsgRZQfJb5+POhCxXUI9Z6bSopBDURTFgRVAnH5tflijojkn708G70D5aQaGPiyCRDkEiHYJEOgSJdAgS6RAk0iFIpEOQSIcgkQ5BIh2CrrPEPicd+rgIUukmbwhBAgQJECRAkABBAgQJECQYW9DkDSFIgCDB6IKmbghBggkImrah8QVN3NAEBE1b0ZME9b3ap/61Mc84JZ4jqPfVPtdbJ8XzBPW/VmP6PEWQ/2qfq/+eGUAJEjyrDup5tc/0eVIrpq/2mQ3PERQwaa8Dh0o04FMi6Hm7DkuKoBAHRtAXJUJQiIMF33VYUgSFODCCvijR1ATFBIIECBIgSIAgAYIECBIgSIAgAYIECBIgSIAgQXhBedJxG6vywTh1TGewn+xm/wcTaYILMndDy31/63HnHmNbxXQG+zFP2Wnu/2CiHoQW5L6e9txHJncLZ+qYzmA/5Q3F1oMT9SG0IHdvofZHbebJ1i56qGO6ghVGUJBEguCCfjXl3PuwVieoihHBnWTmVlghEglCC3IVgbc6sJ+hjhHBXYex93sMkEgyU0HmFHv9MUdBX3aKGR1zPMVEdRmukjZZ5lhJiwY3D9HMOx1Fqjk286LLlgfpKJo7YlonM+woXgwD2iiriTqmM9iPeXb3PkQiDYNVAYIECBIgSIAgAYIECBIgSIAgAYIECBIgSIAgAYIECBIgSIAgAYIECBIgSIAgAYIECBIgSIAgAYIECBKMI6hcDdy4Z1ML+f4i4HS4Cr3d18S/Bf6GfhRB5WrgTyHIvHkOyK4Xt9zsazfk8lmo9zGGoPx8G73+gm4j2wXdFLSBjCCoWg1sFvLaz5Qldknmcffnzq1qSZNk9W319yZJXv/f/bGxG80ux7dvF3coPFZvlathPjb2zk++u4c9yDh1UH5ZguyC3s22eF28ML+kZiF9snp3JajauK4eFFzReMv8dEUq8Dqq8QXZdfNmi31RrzxMK0Fuo/3pQivqt0y9bHZygjoek/sI4wty/+PWwd5tqJbp1XWQ1bi/rnUuN+XmHHOvmxYHMwFB5V3XagdZmyBbLjyCijrs5d9NvIKqOuPREmTdfcQrqNmQVx/Y1LpNQVufILd6P4m2DrINUFUn2w3nVmx7Po9cK+YrQcddsi3LTjytWKMfZHo59VlU9Gte/im2pKYfVG7Mq4iayzpo9Z6a9j6aflAPri+86B613R/XlwkKKhus66r2ZizWTgxjMYVt+G/KQTnIMgMKS3tVE8dofk4gSIAgAYIECBIgSIAgAYIECBIgSIAgAYIECBIgSIAgAYIECBIgSIAgAYIECBL8BMDR48UkVlcBAAAAAElFTkSuQmCC" /><!-- --></p>
<p>We can see that the chain converge. And it seems that the chain doesn’t take a very long step to converge(compared with N=10000). Note that if we choose 1 to initialize random walk Metropolis sampler, the chain cannot converge.</p>
</div>
</div>
<div id="section-25" class="section level3">
<h3>9.7</h3>
<div id="implement-a-gibbs-sampler-to-generate-a-bivariate-normal-chain-x_t-y_t-with-zero-means-unit-standard-deviations-and-correlation-0.9.-plot-the-generated-sample-after-discarding-a-suitable-burn-in-sample.-fit-a-simple-linear-regression-model-ybeta_0beta_1x-to-the-sample-and-check-the-residuals-of-the-model-for-normality-and-constant-variance." class="section level4">
<h4>Implement a Gibbs sampler to generate a bivariate normal chain <span class="math inline">\((X_t, Y_t)\)</span> with zero means, unit standard deviations, and correlation 0.9. Plot the generated sample after discarding a suitable burn-in sample. Fit a simple linear regression model <span class="math inline">\(Y=\beta_0+\beta_1X\)</span> to the sample and check the residuals of the model for normality and constant variance.</h4>
<ul>
<li>First of all, we implement a Gibbs sampler to generate a bivariate normal chain <span class="math inline">\((X_t, Y_t)\)</span> with zero means, unit standard deviations. In this case we simulate 10000 times as the same in 9.4, and we set burn-in sample to 1000.</li>
</ul>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>burn <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, m, <span class="dv">2</span>)</span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a>rho <span class="ot">&lt;-</span> <span class="fl">0.9</span></span>
<span id="cb46-7"><a href="#cb46-7" aria-hidden="true" tabindex="-1"></a>mu1 <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb46-8"><a href="#cb46-8" aria-hidden="true" tabindex="-1"></a>mu2 <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb46-9"><a href="#cb46-9" aria-hidden="true" tabindex="-1"></a>sigma1 <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb46-10"><a href="#cb46-10" aria-hidden="true" tabindex="-1"></a>sigma2 <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb46-11"><a href="#cb46-11" aria-hidden="true" tabindex="-1"></a>s1 <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="dv">1</span><span class="sc">-</span>rho<span class="sc">^</span><span class="dv">2</span>)<span class="sc">*</span>sigma1</span>
<span id="cb46-12"><a href="#cb46-12" aria-hidden="true" tabindex="-1"></a>s2 <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="dv">1</span><span class="sc">-</span>rho<span class="sc">^</span><span class="dv">2</span>)<span class="sc">*</span>sigma2</span>
<span id="cb46-13"><a href="#cb46-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-14"><a href="#cb46-14" aria-hidden="true" tabindex="-1"></a>mean12 <span class="ot">&lt;-</span> <span class="cf">function</span> (x2) mu1 <span class="sc">+</span> rho<span class="sc">*</span>sigma1<span class="sc">/</span>sigma2<span class="sc">*</span>(x2 <span class="sc">-</span> mu2)</span>
<span id="cb46-15"><a href="#cb46-15" aria-hidden="true" tabindex="-1"></a>mean21 <span class="ot">&lt;-</span> <span class="cf">function</span> (x1) mu2 <span class="sc">+</span> rho<span class="sc">*</span>sigma2<span class="sc">/</span>sigma1<span class="sc">*</span>(x1 <span class="sc">-</span> mu1)</span>
<span id="cb46-16"><a href="#cb46-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-17"><a href="#cb46-17" aria-hidden="true" tabindex="-1"></a>x[<span class="dv">1</span>,] <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)</span>
<span id="cb46-18"><a href="#cb46-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-19"><a href="#cb46-19" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>m) {</span>
<span id="cb46-20"><a href="#cb46-20" aria-hidden="true" tabindex="-1"></a>  xt <span class="ot">&lt;-</span> x[i<span class="dv">-1</span>,]</span>
<span id="cb46-21"><a href="#cb46-21" aria-hidden="true" tabindex="-1"></a>  xt[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1</span>, <span class="fu">mean12</span>(xt[<span class="dv">2</span>]), s1)</span>
<span id="cb46-22"><a href="#cb46-22" aria-hidden="true" tabindex="-1"></a>  xt[<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1</span>, <span class="fu">mean21</span>(xt[<span class="dv">1</span>]), s2)</span>
<span id="cb46-23"><a href="#cb46-23" aria-hidden="true" tabindex="-1"></a>  x[i,] <span class="ot">&lt;-</span> xt</span>
<span id="cb46-24"><a href="#cb46-24" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb46-25"><a href="#cb46-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-26"><a href="#cb46-26" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span> burn <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb46-27"><a href="#cb46-27" aria-hidden="true" tabindex="-1"></a>x_final <span class="ot">&lt;-</span> x[b<span class="sc">:</span>m,]</span>
<span id="cb46-28"><a href="#cb46-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-29"><a href="#cb46-29" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> x_final[,<span class="dv">1</span>]</span>
<span id="cb46-30"><a href="#cb46-30" aria-hidden="true" tabindex="-1"></a>Y <span class="ot">&lt;-</span> x_final[,<span class="dv">2</span>]</span>
<span id="cb46-31"><a href="#cb46-31" aria-hidden="true" tabindex="-1"></a>lin.reg <span class="ot">&lt;-</span> <span class="fu">lm</span>(Y <span class="sc">~</span> X)</span>
<span id="cb46-32"><a href="#cb46-32" aria-hidden="true" tabindex="-1"></a>lin.reg</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = Y ~ X)
## 
## Coefficients:
## (Intercept)            X  
##   -0.001086     0.896739</code></pre>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>res <span class="ot">&lt;-</span> lin.reg<span class="sc">$</span>residuals</span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x, <span class="at">cex =</span> <span class="fl">0.5</span>, <span class="at">main =</span> <span class="st">&quot;generated data&quot;</span>, <span class="at">ylab =</span> <span class="st">&#39;Y&#39;</span>, <span class="at">xlab =</span> <span class="st">&#39;X&#39;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ks.test</span>(res,<span class="st">&quot;pnorm&quot;</span>,<span class="at">mean=</span><span class="fu">mean</span>(res),<span class="at">sd=</span><span class="fu">sqrt</span>(<span class="fu">var</span>(res)))</span></code></pre></div>
<pre><code>## 
##  Asymptotic one-sample Kolmogorov-Smirnov test
## 
## data:  res
## D = 0.0061976, p-value = 0.8798
## alternative hypothesis: two-sided</code></pre>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(res,<span class="at">main =</span><span class="st">&quot;Q-Q图&quot;</span>)</span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a><span class="fu">qqline</span>(res)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(lin.reg<span class="sc">$</span>fitted.values, res, <span class="at">cex=</span><span class="fl">0.25</span>)</span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="dv">0</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(lin.reg<span class="sc">$</span>residuals, <span class="at">main =</span> <span class="st">&quot;residuals of linear model&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>From the result, we can easily see that <span class="math inline">\(\beta_1\)</span> is very close to 0.9, which means we generated the samples that match the target distribution very well. And from the scatter plot(after discarding the burn-in sample), the figure has the elliptical symmetry and location at the origin of the target bivariate normal distribution. As for residuals, the QQ plot shows that residuals follow a normal distribution. And the plot of residuals vs fits shows that the error variance is constant. Above these two figures, the histogram of residuals intuitively show that the residuals meet the requirements of linear regression.</p>
<ul>
<li>And then we follow the text book to construct the Gelman-Rubin method. So the scalar summary statistic <span class="math inline">\(\psi_{ij}\)</span> is the mean of the <span class="math inline">\(i^{th}\)</span> chain up to time <span class="math inline">\(j\)</span>. We do not set the simulation numbers this time, the simulation will stop until it converge. And we assume the burn-in sample to 1000, so we sample for at least 1000 times.</li>
</ul>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>Gelman.Rubin <span class="ot">&lt;-</span> <span class="cf">function</span>(psi) {</span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>        <span class="co"># psi[i,j] is the statistic psi(X[i,1:j])</span></span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a>        <span class="co"># for chain in i-th row of X</span></span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a>        psi <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(psi)</span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a>        n <span class="ot">&lt;-</span> <span class="fu">ncol</span>(psi)</span>
<span id="cb54-6"><a href="#cb54-6" aria-hidden="true" tabindex="-1"></a>        k <span class="ot">&lt;-</span> <span class="fu">nrow</span>(psi)</span>
<span id="cb54-7"><a href="#cb54-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-8"><a href="#cb54-8" aria-hidden="true" tabindex="-1"></a>        psi.means <span class="ot">&lt;-</span> <span class="fu">rowMeans</span>(psi)     <span class="co">#row means</span></span>
<span id="cb54-9"><a href="#cb54-9" aria-hidden="true" tabindex="-1"></a>        B <span class="ot">&lt;-</span> n <span class="sc">*</span> <span class="fu">var</span>(psi.means)        <span class="co">#between variance est.</span></span>
<span id="cb54-10"><a href="#cb54-10" aria-hidden="true" tabindex="-1"></a>        psi.w <span class="ot">&lt;-</span> <span class="fu">apply</span>(psi, <span class="dv">1</span>, <span class="st">&quot;var&quot;</span>)  <span class="co">#within variances</span></span>
<span id="cb54-11"><a href="#cb54-11" aria-hidden="true" tabindex="-1"></a>        W <span class="ot">&lt;-</span> <span class="fu">mean</span>(psi.w)               <span class="co">#within est.</span></span>
<span id="cb54-12"><a href="#cb54-12" aria-hidden="true" tabindex="-1"></a>        v.hat <span class="ot">&lt;-</span> W<span class="sc">*</span>(n<span class="dv">-1</span>)<span class="sc">/</span>n <span class="sc">+</span> (B<span class="sc">/</span>n)     <span class="co">#upper variance est.</span></span>
<span id="cb54-13"><a href="#cb54-13" aria-hidden="true" tabindex="-1"></a>        r.hat <span class="ot">&lt;-</span> v.hat <span class="sc">/</span> W             <span class="co">#G-R statistic</span></span>
<span id="cb54-14"><a href="#cb54-14" aria-hidden="true" tabindex="-1"></a>        <span class="fu">return</span>(r.hat)</span>
<span id="cb54-15"><a href="#cb54-15" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb54-16"><a href="#cb54-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-17"><a href="#cb54-17" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="dv">2</span>, <span class="dv">1</span>)</span>
<span id="cb54-18"><a href="#cb54-18" aria-hidden="true" tabindex="-1"></a>psi <span class="ot">&lt;-</span> <span class="fu">t</span>(<span class="fu">apply</span>(x, <span class="dv">1</span>, cumsum))</span>
<span id="cb54-19"><a href="#cb54-19" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(psi)){</span>
<span id="cb54-20"><a href="#cb54-20" aria-hidden="true" tabindex="-1"></a>    psi[i,] <span class="ot">&lt;-</span> psi[i,] <span class="sc">/</span> (<span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(psi))</span>
<span id="cb54-21"><a href="#cb54-21" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb54-22"><a href="#cb54-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-23"><a href="#cb54-23" aria-hidden="true" tabindex="-1"></a>i <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb54-24"><a href="#cb54-24" aria-hidden="true" tabindex="-1"></a>r_hat <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb54-25"><a href="#cb54-25" aria-hidden="true" tabindex="-1"></a>rho <span class="ot">&lt;-</span> <span class="fl">0.9</span></span>
<span id="cb54-26"><a href="#cb54-26" aria-hidden="true" tabindex="-1"></a>mu1 <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb54-27"><a href="#cb54-27" aria-hidden="true" tabindex="-1"></a>mu2 <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb54-28"><a href="#cb54-28" aria-hidden="true" tabindex="-1"></a>sigma1 <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb54-29"><a href="#cb54-29" aria-hidden="true" tabindex="-1"></a>sigma2 <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb54-30"><a href="#cb54-30" aria-hidden="true" tabindex="-1"></a>s1 <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="dv">1</span><span class="sc">-</span>rho<span class="sc">^</span><span class="dv">2</span>)<span class="sc">*</span>sigma1</span>
<span id="cb54-31"><a href="#cb54-31" aria-hidden="true" tabindex="-1"></a>s2 <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="dv">1</span><span class="sc">-</span>rho<span class="sc">^</span><span class="dv">2</span>)<span class="sc">*</span>sigma2</span>
<span id="cb54-32"><a href="#cb54-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-33"><a href="#cb54-33" aria-hidden="true" tabindex="-1"></a>mean12 <span class="ot">&lt;-</span> <span class="cf">function</span> (x2) mu1 <span class="sc">+</span> rho<span class="sc">*</span>sigma1<span class="sc">/</span>sigma2<span class="sc">*</span>(x2 <span class="sc">-</span> mu2)</span>
<span id="cb54-34"><a href="#cb54-34" aria-hidden="true" tabindex="-1"></a>mean21 <span class="ot">&lt;-</span> <span class="cf">function</span> (x1) mu2 <span class="sc">+</span> rho<span class="sc">*</span>sigma2<span class="sc">/</span>sigma1<span class="sc">*</span>(x1 <span class="sc">-</span> mu1)</span>
<span id="cb54-35"><a href="#cb54-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-36"><a href="#cb54-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-37"><a href="#cb54-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-38"><a href="#cb54-38" aria-hidden="true" tabindex="-1"></a><span class="cf">while</span> (i <span class="sc">&lt;=</span> <span class="dv">1000</span> <span class="sc">|</span> <span class="fu">Gelman.Rubin</span>(psi) <span class="sc">&gt;=</span> <span class="fl">1.2</span>) {</span>
<span id="cb54-39"><a href="#cb54-39" aria-hidden="true" tabindex="-1"></a>  i <span class="ot">&lt;-</span> i <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb54-40"><a href="#cb54-40" aria-hidden="true" tabindex="-1"></a>  xt <span class="ot">&lt;-</span> x[,i<span class="dv">-1</span>]</span>
<span id="cb54-41"><a href="#cb54-41" aria-hidden="true" tabindex="-1"></a>  temp <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="dv">2</span>, <span class="dv">1</span>)</span>
<span id="cb54-42"><a href="#cb54-42" aria-hidden="true" tabindex="-1"></a>  temp[<span class="dv">1</span>,<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1</span>, <span class="fu">mean12</span>(xt[<span class="dv">2</span>]), s1)</span>
<span id="cb54-43"><a href="#cb54-43" aria-hidden="true" tabindex="-1"></a>  temp[<span class="dv">2</span>,<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1</span>, <span class="fu">mean21</span>(xt[<span class="dv">1</span>]), s2)</span>
<span id="cb54-44"><a href="#cb54-44" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">cbind</span>(x, temp)</span>
<span id="cb54-45"><a href="#cb54-45" aria-hidden="true" tabindex="-1"></a>  psi <span class="ot">&lt;-</span> <span class="fu">t</span>(<span class="fu">apply</span>(x, <span class="dv">1</span>, cumsum))</span>
<span id="cb54-46"><a href="#cb54-46" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(psi)){</span>
<span id="cb54-47"><a href="#cb54-47" aria-hidden="true" tabindex="-1"></a>    psi[j,] <span class="ot">&lt;-</span> psi[j,] <span class="sc">/</span> (<span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(psi))</span>
<span id="cb54-48"><a href="#cb54-48" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb54-49"><a href="#cb54-49" aria-hidden="true" tabindex="-1"></a>  r_hat[i<span class="dv">-1</span>] <span class="ot">&lt;-</span> <span class="fu">Gelman.Rubin</span>(psi)</span>
<span id="cb54-50"><a href="#cb54-50" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb54-51"><a href="#cb54-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-52"><a href="#cb54-52" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(r_hat)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>From the figure we can see that the burn-in sample can be much smaller than 1000, it converge pretty fast actually.</p>
</div>
</div>
</div>
</div>
<div id="section-26" class="section level1">
<h1>2022-11-05</h1>
<div id="question-8" class="section level2">
<h2>Question</h2>
</div>
<div id="answer-8" class="section level2">
<h2>Answer</h2>
<div id="section-27" class="section level3">
<h3>1</h3>
<p>First of all, we define some parameters. We assume X follow the normal distribution <span class="math inline">\(N(4,25)\)</span>, and <span class="math inline">\(a_M=1.5,a_Y=3.5\)</span>. And from the question we can know that <span class="math inline">\(e_M, e_Y \stackrel{\text{i.i.d}}{\sim}N(0,1)\)</span> and <span class="math inline">\(\tau=1\)</span>.</p>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(mediation)</span></code></pre></div>
<pre><code>## Warning: package &#39;mediation&#39; was built under R version 4.2.2</code></pre>
<pre><code>## Loading required package: MASS</code></pre>
<pre><code>## 
## Attaching package: &#39;MASS&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:DAAG&#39;:
## 
##     hills</code></pre>
<pre><code>## Loading required package: Matrix</code></pre>
<pre><code>## Loading required package: mvtnorm</code></pre>
<pre><code>## Loading required package: sandwich</code></pre>
<pre><code>## Warning: package &#39;sandwich&#39; was built under R version 4.2.2</code></pre>
<pre><code>## mediation: Causal Mediation Analysis
## Version: 4.5.0</code></pre>
<pre><code>## 
## Attaching package: &#39;mediation&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:DAAG&#39;:
## 
##     jobs</code></pre>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a>data_gen <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">N=</span><span class="dv">10000</span>, <span class="at">am=</span><span class="fl">1.5</span>, <span class="at">ay=</span><span class="fl">3.5</span>, alpha, beta, <span class="at">tau=</span><span class="dv">1</span>){</span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(N,<span class="dv">4</span>,<span class="dv">5</span>)</span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a>  em <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(N)</span>
<span id="cb67-4"><a href="#cb67-4" aria-hidden="true" tabindex="-1"></a>  m <span class="ot">&lt;-</span> alpha<span class="sc">*</span>x <span class="sc">+</span> am <span class="sc">+</span> em</span>
<span id="cb67-5"><a href="#cb67-5" aria-hidden="true" tabindex="-1"></a>  ey <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(N)</span>
<span id="cb67-6"><a href="#cb67-6" aria-hidden="true" tabindex="-1"></a>  y <span class="ot">&lt;-</span> beta<span class="sc">*</span>m <span class="sc">+</span> tau<span class="sc">*</span>x <span class="sc">+</span> ey <span class="sc">+</span> ay</span>
<span id="cb67-7"><a href="#cb67-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">cbind</span>(x,m,y))</span>
<span id="cb67-8"><a href="#cb67-8" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb67-9"><a href="#cb67-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-10"><a href="#cb67-10" aria-hidden="true" tabindex="-1"></a>per_f <span class="ot">&lt;-</span> <span class="cf">function</span>(x,m,y,<span class="at">R=</span><span class="dv">300</span>, para){</span>
<span id="cb67-11"><a href="#cb67-11" aria-hidden="true" tabindex="-1"></a>  model_1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(m<span class="sc">~</span>x)</span>
<span id="cb67-12"><a href="#cb67-12" aria-hidden="true" tabindex="-1"></a>  model_2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(y<span class="sc">~</span>x<span class="sc">+</span>m)</span>
<span id="cb67-13"><a href="#cb67-13" aria-hidden="true" tabindex="-1"></a>  re0 <span class="ot">&lt;-</span> <span class="fu">mediate</span>(model_1, model_2, <span class="at">sims =</span> <span class="dv">200</span>, <span class="at">treat =</span> <span class="st">&#39;x&#39;</span>, <span class="at">mediator =</span> <span class="st">&#39;m&#39;</span>)</span>
<span id="cb67-14"><a href="#cb67-14" aria-hidden="true" tabindex="-1"></a>  t0 <span class="ot">&lt;-</span> re0<span class="sc">$</span>d0<span class="sc">/</span><span class="fu">sd</span>(re0<span class="sc">$</span>d0.sims)</span>
<span id="cb67-15"><a href="#cb67-15" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb67-16"><a href="#cb67-16" aria-hidden="true" tabindex="-1"></a>  t <span class="ot">&lt;-</span> <span class="fu">numeric</span>(R)</span>
<span id="cb67-17"><a href="#cb67-17" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(para <span class="sc">==</span> <span class="dv">1</span>){</span>
<span id="cb67-18"><a href="#cb67-18" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>R) {</span>
<span id="cb67-19"><a href="#cb67-19" aria-hidden="true" tabindex="-1"></a>      mstar <span class="ot">&lt;-</span> <span class="fu">sample</span>(m,<span class="at">replace =</span> <span class="cn">FALSE</span>)</span>
<span id="cb67-20"><a href="#cb67-20" aria-hidden="true" tabindex="-1"></a>      xstar <span class="ot">&lt;-</span> x</span>
<span id="cb67-21"><a href="#cb67-21" aria-hidden="true" tabindex="-1"></a>      ystar <span class="ot">&lt;-</span> y</span>
<span id="cb67-22"><a href="#cb67-22" aria-hidden="true" tabindex="-1"></a>      model_1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(mstar<span class="sc">~</span>xstar)</span>
<span id="cb67-23"><a href="#cb67-23" aria-hidden="true" tabindex="-1"></a>      model_2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(ystar<span class="sc">~</span>mstar<span class="sc">+</span>xstar)</span>
<span id="cb67-24"><a href="#cb67-24" aria-hidden="true" tabindex="-1"></a>      re <span class="ot">&lt;-</span> <span class="fu">mediate</span>(model_1, model_2, <span class="at">sims =</span> <span class="dv">200</span>, <span class="at">treat =</span> <span class="st">&#39;xstar&#39;</span>, <span class="at">mediator =</span> <span class="st">&#39;mstar&#39;</span>)</span>
<span id="cb67-25"><a href="#cb67-25" aria-hidden="true" tabindex="-1"></a>      t[i] <span class="ot">&lt;-</span> re<span class="sc">$</span>d0<span class="sc">/</span><span class="fu">sd</span>(re<span class="sc">$</span>d0.sims)</span>
<span id="cb67-26"><a href="#cb67-26" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb67-27"><a href="#cb67-27" aria-hidden="true" tabindex="-1"></a>    p_value <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">abs</span>(<span class="fu">c</span>(t0,t))<span class="sc">&gt;=</span><span class="fu">abs</span>(t0))</span>
<span id="cb67-28"><a href="#cb67-28" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">&#39;Case1 p_value: &#39;</span>, p_value))</span>
<span id="cb67-29"><a href="#cb67-29" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb67-30"><a href="#cb67-30" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(para <span class="sc">==</span> <span class="dv">2</span>){</span>
<span id="cb67-31"><a href="#cb67-31" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>R) {</span>
<span id="cb67-32"><a href="#cb67-32" aria-hidden="true" tabindex="-1"></a>      mstar <span class="ot">&lt;-</span> m</span>
<span id="cb67-33"><a href="#cb67-33" aria-hidden="true" tabindex="-1"></a>      xstar <span class="ot">&lt;-</span> <span class="fu">sample</span>(x,<span class="at">replace =</span> <span class="cn">FALSE</span>)</span>
<span id="cb67-34"><a href="#cb67-34" aria-hidden="true" tabindex="-1"></a>      ystar <span class="ot">&lt;-</span> y</span>
<span id="cb67-35"><a href="#cb67-35" aria-hidden="true" tabindex="-1"></a>      model_1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(mstar<span class="sc">~</span>xstar)</span>
<span id="cb67-36"><a href="#cb67-36" aria-hidden="true" tabindex="-1"></a>      model_2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(ystar<span class="sc">~</span>mstar<span class="sc">+</span>xstar)</span>
<span id="cb67-37"><a href="#cb67-37" aria-hidden="true" tabindex="-1"></a>      re <span class="ot">&lt;-</span> <span class="fu">mediate</span>(model_1, model_2, <span class="at">sims =</span> <span class="dv">200</span>, <span class="at">treat =</span> <span class="st">&#39;xstar&#39;</span>, <span class="at">mediator =</span> <span class="st">&#39;mstar&#39;</span>)</span>
<span id="cb67-38"><a href="#cb67-38" aria-hidden="true" tabindex="-1"></a>      t[i] <span class="ot">&lt;-</span> re<span class="sc">$</span>d0<span class="sc">/</span><span class="fu">sd</span>(re<span class="sc">$</span>d0.sims)</span>
<span id="cb67-39"><a href="#cb67-39" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb67-40"><a href="#cb67-40" aria-hidden="true" tabindex="-1"></a>    p_value <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">abs</span>(<span class="fu">c</span>(t0,t))<span class="sc">&gt;=</span><span class="fu">abs</span>(t0))</span>
<span id="cb67-41"><a href="#cb67-41" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">&#39;Case2 p_value: &#39;</span>, p_value))</span>
<span id="cb67-42"><a href="#cb67-42" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb67-43"><a href="#cb67-43" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(para <span class="sc">==</span> <span class="dv">3</span>){</span>
<span id="cb67-44"><a href="#cb67-44" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>R) {</span>
<span id="cb67-45"><a href="#cb67-45" aria-hidden="true" tabindex="-1"></a>      mstar <span class="ot">&lt;-</span> m</span>
<span id="cb67-46"><a href="#cb67-46" aria-hidden="true" tabindex="-1"></a>      xstar <span class="ot">&lt;-</span> x</span>
<span id="cb67-47"><a href="#cb67-47" aria-hidden="true" tabindex="-1"></a>      ystar <span class="ot">&lt;-</span> <span class="fu">sample</span>(y,<span class="at">replace =</span> <span class="cn">FALSE</span>)</span>
<span id="cb67-48"><a href="#cb67-48" aria-hidden="true" tabindex="-1"></a>      model_1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(mstar<span class="sc">~</span>xstar)</span>
<span id="cb67-49"><a href="#cb67-49" aria-hidden="true" tabindex="-1"></a>      model_2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(ystar<span class="sc">~</span>mstar<span class="sc">+</span>xstar)</span>
<span id="cb67-50"><a href="#cb67-50" aria-hidden="true" tabindex="-1"></a>      re <span class="ot">&lt;-</span> <span class="fu">mediate</span>(model_1, model_2, <span class="at">sims =</span> <span class="dv">200</span>, <span class="at">treat =</span> <span class="st">&#39;xstar&#39;</span>, <span class="at">mediator =</span> <span class="st">&#39;mstar&#39;</span>)</span>
<span id="cb67-51"><a href="#cb67-51" aria-hidden="true" tabindex="-1"></a>      t[i] <span class="ot">&lt;-</span> re<span class="sc">$</span>d0<span class="sc">/</span><span class="fu">sd</span>(re<span class="sc">$</span>d0.sims)</span>
<span id="cb67-52"><a href="#cb67-52" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb67-53"><a href="#cb67-53" aria-hidden="true" tabindex="-1"></a>    p_value <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">abs</span>(<span class="fu">c</span>(t0,t))<span class="sc">&gt;=</span><span class="fu">abs</span>(t0))</span>
<span id="cb67-54"><a href="#cb67-54" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">&#39;Case3 p_value: &#39;</span>, p_value))</span>
<span id="cb67-55"><a href="#cb67-55" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb67-56"><a href="#cb67-56" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<div id="alpha0beta0" class="section level4">
<h4>(1) <span class="math inline">\(\alpha=0,\beta=0\)</span></h4>
<p>In this case, M is independent with both X and Y. So we only need to permute m, which means <span class="math inline">\(para=1\)</span>.</p>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="co"># data &lt;- data_gen(alpha=0,beta=0)</span></span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a><span class="co"># per_f(data[,1],data[,2],data[,3],para=1)</span></span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a><span class="co"># data &lt;- data_gen(alpha=2,beta=3)</span></span>
<span id="cb68-4"><a href="#cb68-4" aria-hidden="true" tabindex="-1"></a><span class="co"># per_f(data[,1],data[,2],data[,3],para=1)</span></span></code></pre></div>
<p>From the result we can see that if we generate data following <span class="math inline">\(\alpha=\beta=0\)</span>, the p-value is very large, so we cannot reject that <span class="math inline">\(\alpha=\beta=0\)</span></p>
</div>
<div id="alpha0beta1" class="section level4">
<h4>(2) <span class="math inline">\(\alpha=0,\beta=1\)</span></h4>
<p>In this case, M is independent with X. So we only need to permute x, which means <span class="math inline">\(para=2\)</span>.</p>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="co"># data &lt;- data_gen(alpha=0,beta=1)</span></span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a><span class="co"># per_f(data[,1],data[,2],data[,3],para=2)</span></span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a><span class="co"># data &lt;- data_gen(alpha=2,beta=3)</span></span>
<span id="cb69-4"><a href="#cb69-4" aria-hidden="true" tabindex="-1"></a><span class="co"># per_f(data[,1],data[,2],data[,3],para=1)</span></span></code></pre></div>
<p>From the result we can see that if we generate data following <span class="math inline">\(\alpha=0,\beta=1\)</span>, the p-value is very large, so we cannot reject that <span class="math inline">\(\alpha=0, \beta=1\)</span></p>
</div>
<div id="alpha1beta0" class="section level4">
<h4>(3) <span class="math inline">\(\alpha=1,\beta=0\)</span></h4>
<p>In this case, M is independent with Y. So we only need to permute Y, which means <span class="math inline">\(para=3\)</span>.</p>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="co"># data &lt;- data_gen(alpha=1,beta=0)</span></span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a><span class="co"># per_f(data[,1],data[,2],data[,3],para=3)</span></span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a><span class="co"># data &lt;- data_gen(alpha=2,beta=3)</span></span>
<span id="cb70-4"><a href="#cb70-4" aria-hidden="true" tabindex="-1"></a><span class="co"># per_f(data[,1],data[,2],data[,3],para=3)</span></span></code></pre></div>
<p>From the result we can see that if we generate data following <span class="math inline">\(\alpha=1,\beta=0\)</span>, the p-value is very large, so we cannot reject that <span class="math inline">\(\alpha=1, \beta=0\)</span></p>
</div>
</div>
<div id="section-28" class="section level3">
<h3>2</h3>
<div id="write-a-r-function-to-get-alpha" class="section level4">
<h4>(1) Write a R function to get <span class="math inline">\(\alpha\)</span></h4>
<p>As we know from the class that the algorithm to get <span class="math inline">\(\alpha\)</span> is listed below:</p>
<ol style="list-style-type: decimal">
<li><p>Specify <span class="math inline">\(f_0, b_1, b_2, b_3, N\)</span>(large enough)</p></li>
<li><p>Generate<span class="math inline">\((x_{1i},x_{2i}),\quad i=1,...,N\)</span></p></li>
<li><p>Write a function with <span class="math inline">\(\alpha\)</span> to approximate <span class="math inline">\(P(D=1)=f_0\)</span>: <span class="math display">\[g(\alpha)=\frac{1}{N}\sum_{i=1}^{N}\frac{1}{1+e^{-\alpha-b_1x_{1i}-b_2x_{2i}-b_3x_{3i}}}-f_0\]</span></p></li>
<li><p>Solve <span class="math inline">\(g(\alpha)=0\)</span> using uniroot.</p></li>
</ol>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a>f <span class="ot">&lt;-</span> <span class="cf">function</span>(N,b1,b2,b3,f0){</span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a>  x1 <span class="ot">&lt;-</span> <span class="fu">rpois</span>(N,<span class="dv">1</span>)</span>
<span id="cb71-4"><a href="#cb71-4" aria-hidden="true" tabindex="-1"></a>  x2 <span class="ot">&lt;-</span> <span class="fu">rexp</span>(N,<span class="dv">1</span>)</span>
<span id="cb71-5"><a href="#cb71-5" aria-hidden="true" tabindex="-1"></a>  x3 <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(N,<span class="dv">1</span>,<span class="fl">0.5</span>)</span>
<span id="cb71-6"><a href="#cb71-6" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb71-7"><a href="#cb71-7" aria-hidden="true" tabindex="-1"></a>  g <span class="ot">&lt;-</span> <span class="cf">function</span>(alpha){</span>
<span id="cb71-8"><a href="#cb71-8" aria-hidden="true" tabindex="-1"></a>    temp <span class="ot">&lt;-</span> <span class="fu">exp</span>(<span class="sc">-</span>alpha<span class="sc">-</span>b1<span class="sc">*</span>x1<span class="sc">-</span>b2<span class="sc">*</span>x2<span class="sc">-</span>b3<span class="sc">*</span>x3)</span>
<span id="cb71-9"><a href="#cb71-9" aria-hidden="true" tabindex="-1"></a>    p <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span>(<span class="dv">1</span><span class="sc">+</span>temp)</span>
<span id="cb71-10"><a href="#cb71-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mean</span>(p)<span class="sc">-</span>f0</span>
<span id="cb71-11"><a href="#cb71-11" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb71-12"><a href="#cb71-12" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb71-13"><a href="#cb71-13" aria-hidden="true" tabindex="-1"></a>  solution <span class="ot">&lt;-</span> <span class="fu">uniroot</span>(g,<span class="fu">c</span>(<span class="sc">-</span><span class="dv">20</span>,<span class="dv">0</span>))</span>
<span id="cb71-14"><a href="#cb71-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(solution<span class="sc">$</span>root)</span>
<span id="cb71-15"><a href="#cb71-15" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
</div>
<div id="set-n106b_10b_21b_3-1f_00.10.010.0010.0001." class="section level4">
<h4>(2) Set <span class="math inline">\(N=10^6,b_1=0,b_2=1,b_3=-1,f_0=0.1,0.01,0.001,0.0001\)</span>.</h4>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">10</span><span class="sc">^</span><span class="dv">6</span></span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a>b1 <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a>b2 <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb72-4"><a href="#cb72-4" aria-hidden="true" tabindex="-1"></a>b3 <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">1</span></span>
<span id="cb72-5"><a href="#cb72-5" aria-hidden="true" tabindex="-1"></a>f0s <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.1</span>,<span class="fl">0.01</span>,<span class="fl">0.001</span>,<span class="fl">0.0001</span>)</span>
<span id="cb72-6"><a href="#cb72-6" aria-hidden="true" tabindex="-1"></a>alphas <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb72-7"><a href="#cb72-7" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (f0 <span class="cf">in</span> f0s) {</span>
<span id="cb72-8"><a href="#cb72-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb72-9"><a href="#cb72-9" aria-hidden="true" tabindex="-1"></a>  alpha <span class="ot">&lt;-</span> <span class="fu">f</span>(N,b1,b2,b3,f0)</span>
<span id="cb72-10"><a href="#cb72-10" aria-hidden="true" tabindex="-1"></a>  alphas <span class="ot">&lt;-</span> <span class="fu">c</span>(alphas, alpha)</span>
<span id="cb72-11"><a href="#cb72-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(alpha)</span>
<span id="cb72-12"><a href="#cb72-12" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## [1] -3.165451
## [1] -6.068882
## [1] -8.717683
## [1] -11.30465</code></pre>
</div>
<div id="plot-f_0-quad-vs-quad-alpha" class="section level4">
<h4>(3) Plot <span class="math inline">\(f_0 \quad vs \quad \alpha\)</span></h4>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(f0s,alphas, <span class="at">xlab =</span> <span class="st">&#39;f0&#39;</span>, <span class="at">ylab =</span> <span class="st">&#39;alpha&#39;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>From the picture we can see that with the increase of <span class="math inline">\(f_0\)</span>, <span class="math inline">\(\alpha\)</span> gets larger too.</p>
</div>
</div>
</div>
</div>
<div id="section-29" class="section level1">
<h1>2022-11-11</h1>
<div id="question-9" class="section level2">
<h2>Question</h2>
<ol style="list-style-type: decimal">
<li><p>Handwrite problem</p></li>
<li><p>2.1.3 Exercise 4, 5 (Pages 19 Advanced in R)</p></li>
<li><p>2.3.1 Exercise 1, 2 (Pages 26 Advanced in R)</p></li>
<li><p>2.4.5 Exercise 1, 2, 3 (Pages 30 Advanced in R)</p></li>
</ol>
</div>
<div id="answer-9" class="section level2">
<h2>Answer</h2>
<div id="section-30" class="section level3">
<h3>1</h3>
<div id="mle" class="section level4">
<h4>MLE</h4>
<p>It’s easy to know that the likelihood function is <span class="math display">\[L(\lambda)=\prod_{j=1}^{n}P_{\lambda}(u_j\le X_j \le v_j)\]</span>.</p>
<p>So we can get log-likelihood function <span class="math display">\[lnL=\sum_{j=1}^{n}ln(e^{-\lambda u_j}-e^{\lambda v_j})\]</span></p>
<p>And let score function equal to zero, we have<span class="math display">\[\frac{\partial lnL}{\partial\lambda}=\sum_{j=1}^{n}\frac{-u_je^{-\lambda u_j}+v_je^{-\lambda v_j}}{e^{-\lambda u_j}-e^{-\lambda v_j}}=0\quad\quad\quad(1)\]</span></p>
<p>Solve this equation we can get <span class="math inline">\(\hat{\lambda}_{MLE}\)</span> but we cannot get its explicit expression. So we need the help with EM algorithm to estimate <span class="math inline">\(\lambda\)</span>.</p>
</div>
<div id="em-algorithm" class="section level4">
<h4>EM algorithm</h4>
<p><span class="math inline">\(\textbf{E step:}\)</span> We assume that <span class="math inline">\(Y=(Y_1,...,Y_n)^T\)</span> is the observations of <span class="math inline">\(X=(X_1,...,X_n)^T\)</span>, so X contains all information about observation Y.</p>
<p>So <span class="math display">\[f(\lambda|X,Y)=f(\lambda|X)\]</span>.</p>
<p>And we know that<span class="math inline">\(X_j \sim Exp(\lambda)\quad i.i.d\)</span>, we can get functions like below: <span class="math display">\[\begin{aligned}
&amp;\because f(\lambda|X)=\prod_{j=1}^{n}(\lambda e^{-\lambda X_j})\\
&amp;\therefore lnf(\lambda|X)=\sum_{j=1}^{n}ln[\lambda e^{-\lambda X_j}]=nln\lambda-\lambda\sum_{j=1}^{n}X_j\\
&amp;\therefore Q(\lambda|\lambda^{(i)},Y)=E[lnf(\lambda|X)|\lambda^{(i)},Y]=nln\lambda-\lambda\sum_{j=1}^{n}E(X_i|\lambda^{(i)},Y)
\end{aligned}\]</span></p>
<p>The conditional density function of<span class="math inline">\(X_j\)</span> is:<span class="math display">\[f_j(t|\lambda^{(i)},Y)=\frac{\lambda^{(i)}e^{-\lambda^{(i)}t}}{\int_{u_j}^{v_j}\lambda^{(i)}e^{-\lambda^{(i)}t}dt}=\frac{\lambda^{(i)}e^{-\lambda^{(i)}t}}{e^{-\lambda^{(i)}u_j}-e^{-\lambda^{(i)}v_j}}\]</span></p>
<p>So we can finally get Q function<span class="math display">\[Q(\lambda|\lambda^{(i)},Y)=nln\lambda-\lambda\sum_{j=1}^{n}\int_{u_j}^{v_j}xf_j(t|\lambda^{(i)},Y)dx\]</span></p>
<p><span class="math inline">\(\textbf{M step:}\)</span> We need to get <span class="math inline">\(\lambda^{(i+1)}\)</span> which makes Q function achieve maximum.</p>
<p>Let <span class="math display">\[\frac{\partial Q(\lambda|\lambda^{(i)},Y)}{\partial \lambda}=\frac{n}{\lambda}-\sum_{j=1}^{n}\int_{u_j}^{v_j}xf_j(t|\lambda^{(i)},Y)dx=0\]</span></p>
<p>Therefore <span class="math display">\[\lambda^{(i+1)}=\frac{n}{\sum_{j=1}^{n}[\frac{1}{\lambda^{(i)}}-\frac{u_je^{-\lambda^{(i)}u_j}-v_je^{-\lambda^{(i)}v_j}}{e^{-\lambda^{(i)}u_j}-e^{-\lambda^{(i)}v_j}}]} \quad\quad\quad(2)\]</span></p>
<p>And the iteration stops when <span class="math inline">\(||\lambda^{(i)}-\lambda^{(i+1)}||\)</span> is extremely small, so we can approximately consider <span class="math inline">\(\lambda^{(i)}=\lambda^{(i+1)}\)</span>.</p>
<p>In this case, from the equation(2) we can know <span class="math inline">\(\sum_{j=1}^{n}\lambda^{(i+1)}\frac{u_je^{-\lambda^{(i+1)}u_j}-v_je^{-\lambda^{(i+1)}v_j}}{e^{-\lambda^{(i+1)}u_j}-e^{-\lambda^{(i+1)}v_j}}=0\rightarrow\sum_{j=1}^{n}\frac{u_je^{-\lambda^{(i+1)}u_j}-v_je^{-\lambda^{(i+1)}v_j}}{e^{-\lambda^{(i+1)}u_j}-e^{-\lambda^{(i+1)}v_j}}=0\)</span></p>
<p>So <span class="math inline">\(\lambda^{(i+1)}\)</span> satisfies the equation(1), which means two methods get same result finally.</p>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a>u <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">11</span>, <span class="dv">8</span>, <span class="dv">27</span>, <span class="dv">13</span>, <span class="dv">16</span>, <span class="dv">0</span>, <span class="dv">23</span>, <span class="dv">10</span>, <span class="dv">24</span>, <span class="dv">2</span>)</span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a>v <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">12</span>, <span class="dv">9</span>, <span class="dv">28</span>, <span class="dv">14</span>, <span class="dv">17</span>, <span class="dv">1</span>, <span class="dv">24</span>, <span class="dv">11</span>, <span class="dv">25</span>, <span class="dv">3</span>) </span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-4"><a href="#cb75-4" aria-hidden="true" tabindex="-1"></a>g <span class="ot">&lt;-</span> <span class="cf">function</span>(lambda){</span>
<span id="cb75-5"><a href="#cb75-5" aria-hidden="true" tabindex="-1"></a>  u <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">11</span>,<span class="dv">8</span>,<span class="dv">27</span>,<span class="dv">13</span>,<span class="dv">16</span>,<span class="dv">0</span>,<span class="dv">23</span>,<span class="dv">10</span>,<span class="dv">24</span>,<span class="dv">2</span>)</span>
<span id="cb75-6"><a href="#cb75-6" aria-hidden="true" tabindex="-1"></a>  v <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">12</span>,<span class="dv">9</span>,<span class="dv">28</span>,<span class="dv">14</span>,<span class="dv">17</span>,<span class="dv">1</span>,<span class="dv">24</span>,<span class="dv">11</span>,<span class="dv">25</span>,<span class="dv">3</span>)</span>
<span id="cb75-7"><a href="#cb75-7" aria-hidden="true" tabindex="-1"></a>  re <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb75-8"><a href="#cb75-8" aria-hidden="true" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">length</span>(u)</span>
<span id="cb75-9"><a href="#cb75-9" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n) {</span>
<span id="cb75-10"><a href="#cb75-10" aria-hidden="true" tabindex="-1"></a>    re <span class="ot">&lt;-</span> re <span class="sc">+</span> (u[i]<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>lambda<span class="sc">*</span>u[i])<span class="sc">-</span>v[i]<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>lambda<span class="sc">*</span>v[i]))<span class="sc">/</span>(<span class="fu">exp</span>(<span class="sc">-</span>lambda<span class="sc">*</span>u[i])<span class="sc">-</span><span class="fu">exp</span>(<span class="sc">-</span>lambda<span class="sc">*</span>v[i]))</span>
<span id="cb75-11"><a href="#cb75-11" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb75-12"><a href="#cb75-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(re)</span>
<span id="cb75-13"><a href="#cb75-13" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb75-14"><a href="#cb75-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-15"><a href="#cb75-15" aria-hidden="true" tabindex="-1"></a>lambda_mle <span class="ot">&lt;-</span> <span class="fu">uniroot</span>(g,<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">10</span>))<span class="sc">$</span>root</span>
<span id="cb75-16"><a href="#cb75-16" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">&#39;The numerical solution of MLE of lambda is: &#39;</span>,lambda_mle))</span></code></pre></div>
<pre><code>## [1] &quot;The numerical solution of MLE of lambda is: 0.0719682139748953&quot;</code></pre>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a>iter <span class="ot">&lt;-</span> <span class="cf">function</span>(lambda){</span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a>  u <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">11</span>, <span class="dv">8</span>, <span class="dv">27</span>, <span class="dv">13</span>, <span class="dv">16</span>, <span class="dv">0</span>, <span class="dv">23</span>, <span class="dv">10</span>, <span class="dv">24</span>, <span class="dv">2</span>)</span>
<span id="cb77-3"><a href="#cb77-3" aria-hidden="true" tabindex="-1"></a>  v <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">12</span>, <span class="dv">9</span>, <span class="dv">28</span>, <span class="dv">14</span>, <span class="dv">17</span>, <span class="dv">1</span>, <span class="dv">24</span>, <span class="dv">11</span>, <span class="dv">25</span>, <span class="dv">3</span>) </span>
<span id="cb77-4"><a href="#cb77-4" aria-hidden="true" tabindex="-1"></a>  re <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb77-5"><a href="#cb77-5" aria-hidden="true" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">length</span>(u)</span>
<span id="cb77-6"><a href="#cb77-6" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n) {</span>
<span id="cb77-7"><a href="#cb77-7" aria-hidden="true" tabindex="-1"></a>    re <span class="ot">&lt;-</span> re <span class="sc">+</span> <span class="dv">1</span><span class="sc">/</span>lambda <span class="sc">+</span> (u[i]<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>lambda<span class="sc">*</span>u[i])<span class="sc">-</span>v[i]<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>lambda<span class="sc">*</span>v[i]))<span class="sc">/</span>(<span class="fu">exp</span>(<span class="sc">-</span>lambda<span class="sc">*</span>u[i])<span class="sc">-</span><span class="fu">exp</span>(<span class="sc">-</span>lambda<span class="sc">*</span>v[i]))</span>
<span id="cb77-8"><a href="#cb77-8" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb77-9"><a href="#cb77-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(n<span class="sc">/</span>re)</span>
<span id="cb77-10"><a href="#cb77-10" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb77-11"><a href="#cb77-11" aria-hidden="true" tabindex="-1"></a>f <span class="ot">&lt;-</span> <span class="cf">function</span>(lambda0){</span>
<span id="cb77-12"><a href="#cb77-12" aria-hidden="true" tabindex="-1"></a>  k <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb77-13"><a href="#cb77-13" aria-hidden="true" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">length</span>(u)</span>
<span id="cb77-14"><a href="#cb77-14" aria-hidden="true" tabindex="-1"></a>  lambda_old <span class="ot">&lt;-</span> <span class="fu">iter</span>(lambda0)</span>
<span id="cb77-15"><a href="#cb77-15" aria-hidden="true" tabindex="-1"></a>  lambda_new <span class="ot">&lt;-</span> <span class="fu">iter</span>(lambda_old)</span>
<span id="cb77-16"><a href="#cb77-16" aria-hidden="true" tabindex="-1"></a>  <span class="cf">while</span> (<span class="fu">abs</span>(lambda_old<span class="sc">-</span>lambda_new)<span class="sc">&gt;=</span><span class="fl">1e-6</span>) {</span>
<span id="cb77-17"><a href="#cb77-17" aria-hidden="true" tabindex="-1"></a>    lambda_old <span class="ot">&lt;-</span> lambda_new</span>
<span id="cb77-18"><a href="#cb77-18" aria-hidden="true" tabindex="-1"></a>    lambda_new <span class="ot">&lt;-</span> <span class="fu">iter</span>(lambda_old)</span>
<span id="cb77-19"><a href="#cb77-19" aria-hidden="true" tabindex="-1"></a>    k <span class="ot">&lt;-</span> k <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb77-20"><a href="#cb77-20" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb77-21"><a href="#cb77-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(lambda_new)</span>
<span id="cb77-22"><a href="#cb77-22" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb77-23"><a href="#cb77-23" aria-hidden="true" tabindex="-1"></a>lambda_em <span class="ot">&lt;-</span> <span class="fu">f</span>(<span class="dv">1</span>)</span>
<span id="cb77-24"><a href="#cb77-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-25"><a href="#cb77-25" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">&#39;The numerical solution of MLE of lambda obtained by EM algorithm is: &#39;</span>,lambda_em))</span></code></pre></div>
<pre><code>## [1] &quot;The numerical solution of MLE of lambda obtained by EM algorithm is: 0.0719734996987992&quot;</code></pre>
</div>
</div>
<div id="exercise-4" class="section level3">
<h3>2.1.3 Exercise 4</h3>
<div id="why-do-you-nedd-to-use-unlist-to-covert-a-list-to-an-atomic-vector-why-doesnt-as.vector-work" class="section level4">
<h4>Why do you nedd to use unlist() to covert a list to an atomic vector? Why doesn’t as.vector() work?</h4>
<p>There are two kinds of vector in R: atomic and list. The elements in atomic must be same, but the elements in list can be different. If the list contains same kind of elements(integer, character, etc.), as.vector() can work as unlist(). If the list contains several kinds elements, as.vector() will turn it into a list. But unlist() function will turn all the elements into character and output an atomic vector, no matter the elements are the same kind or not.</p>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="fu">list</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>),<span class="st">&#39;a&#39;</span>)</span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">&#39;result of as.vector():&#39;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;result of as.vector():&quot;</code></pre>
<div class="sourceCode" id="cb81"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">as.vector</span>(a))</span></code></pre></div>
<pre><code>## [[1]]
## [[1]][[1]]
## [1] 1
## 
## [[1]][[2]]
## [1] 2
## 
## [[1]][[3]]
## [1] 3
## 
## [[1]][[4]]
## [1] 4
## 
## 
## [[2]]
## [1] &quot;a&quot;</code></pre>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">&#39;result of unlist():&#39;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;result of unlist():&quot;</code></pre>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">unlist</span>(a))</span></code></pre></div>
<pre><code>## [1] &quot;1&quot; &quot;2&quot; &quot;3&quot; &quot;4&quot; &quot;a&quot;</code></pre>
</div>
</div>
<div id="exercise-5" class="section level3">
<h3>2.1.3 Exercise 5</h3>
<div id="why-is-11-true-why-is--1-false-true-why-is-one-2-false" class="section level4">
<h4>Why is 1==“1” true? Why is -1 &lt; FALSE true? Why is “one” &lt; 2 false?</h4>
<p>If the two arguments are atomic vectors of different types, one is coerced to the type of the other, the (decreasing) order of precedence being character, complex, numeric, integer, logical and raw.</p>
<p>So 1==‘1’ is true, sine numeric(1) transferred into character(1), so it’s the same as “1”.</p>
<p>And FALSE is logical element, when compared with -1(numeric), FALSE will be transferred into numeric type, so -1 is compare with as.numeric(FALSE)=0 actually, and -1&lt;0 is true.</p>
<p>As for “one” and 2, since 2 is numeric type, it will be transferred into character “two”, and the comparison between character relies on alphabetical order. And the order of ‘o’ comes before ‘t’, so “one” &gt; “two”. Thus, “one” &lt; 2 false.</p>
</div>
</div>
<div id="exercise-1" class="section level3">
<h3>2.3.1 Exercise 1</h3>
<div id="what-does-dim-return-when-applied-to-a-vector" class="section level4">
<h4>What does dim() return when applied to a vector?</h4>
<p>It will return NULL. Because dim() function is aimed at matrix, array or dataframe.</p>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>))</span></code></pre></div>
<pre><code>## NULL</code></pre>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(<span class="fu">array</span>(<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>),<span class="dv">1</span>))</span></code></pre></div>
<pre><code>## [1] 1</code></pre>
</div>
</div>
<div id="exercise-2" class="section level3">
<h3>2.3.1 Exercise 2</h3>
<div id="if-is.matrixx-is-true-what-will-is.arrayx-return" class="section level4">
<h4>If is.matrix(x) is TRUE, what will is.array(x) return?</h4>
<p>It will return TRUE, matrix is a special case of array. Since the dim of matrix onpy up tp 2, but array can have many dimensions.</p>
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a>a<span class="ot">=</span><span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="st">&#39;4&#39;</span>,<span class="dv">5</span>,<span class="dv">6</span>),<span class="at">nrow=</span><span class="dv">2</span>)</span>
<span id="cb91-2"><a href="#cb91-2" aria-hidden="true" tabindex="-1"></a><span class="fu">is.matrix</span>(a)</span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<div class="sourceCode" id="cb93"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a><span class="fu">is.array</span>(a)</span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
</div>
</div>
<div id="exercise-1-1" class="section level3">
<h3>2.4.5 Exercise 1</h3>
<div id="what-attributes-does-a-data-frame-possess" class="section level4">
<h4>What attributes does a data frame possess?</h4>
<p>names, row.names and class.</p>
</div>
</div>
<div id="exercise-2-1" class="section level3">
<h3>2.4.5 Exercise 2</h3>
<div id="what-does-as.matrix-do-when-applied-to-a-data-frame-with-columns-of-different-types" class="section level4">
<h4>What does as.matrix() do when applied to a data frame with columns of different types?</h4>
<p>as.matrix is a generic function. The method for data frames will return a character matrix if there is only atomic columns and any non-(numeric/logical/complex) column, applying as.vector to factors and format to other non-character columns. Otherwise, the usual coercion hierarchy (logical &lt; integer &lt; double &lt; complex) will be used, e.g., all-logical data frames will be coerced to a logical matrix, mixed logical-integer will give a integer matrix, etc.</p>
<div class="sourceCode" id="cb95"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="st">&#39;num&#39;</span><span class="ot">=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>),<span class="at">nrow=</span><span class="st">&#39;a&#39;</span>,<span class="at">log=</span><span class="cn">TRUE</span>)</span>
<span id="cb95-2"><a href="#cb95-2" aria-hidden="true" tabindex="-1"></a>a</span></code></pre></div>
<pre><code>##   num nrow  log
## 1   1    a TRUE
## 2   2    a TRUE
## 3   3    a TRUE</code></pre>
<div class="sourceCode" id="cb97"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a><span class="fu">as.matrix</span>(a)</span></code></pre></div>
<pre><code>##      num nrow log   
## [1,] &quot;1&quot; &quot;a&quot;  &quot;TRUE&quot;
## [2,] &quot;2&quot; &quot;a&quot;  &quot;TRUE&quot;
## [3,] &quot;3&quot; &quot;a&quot;  &quot;TRUE&quot;</code></pre>
</div>
</div>
<div id="exercise-3" class="section level3">
<h3>2.4.5 Exercise 3</h3>
<div id="can-you-have-a-data-frame-with-0-rows-what-about-0-columns" class="section level4">
<h4>Can you have a data frame with 0 rows? What about 0 columns?</h4>
<p>Yes, you can create a data frame with 0 rows and 0 columns like below.</p>
<div class="sourceCode" id="cb99"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="fu">data.frame</span>()</span></code></pre></div>
</div>
</div>
</div>
</div>
<div id="section-31" class="section level1">
<h1>2022-11-19</h1>
<div id="question-10" class="section level2">
<h2>Question</h2>
<ol style="list-style-type: decimal">
<li><p>1</p></li>
<li><p>2</p></li>
<li><p>Implement a Gibbs sampler to generate a bivariate normal chain <span class="math inline">\((X_t,Y_t)\)</span> with zero means, unit standard deviations, and correlation 0.9.</p></li>
</ol>
<ul>
<li><p>Write an Rcpp function.</p></li>
<li><p>Compare the corresponding generated random numbers with pure R language using the function “qqplot”.</p></li>
<li><p>Compare the computation time of the two functions with the function “microbenchmark”</p></li>
</ul>
</div>
<div id="answer-10" class="section level2">
<h2>Answer</h2>
<div id="section-32" class="section level3">
<h3>1</h3>
<div id="the-function-below-scales-a-vector-so-it-falls-in-the-range-0-1.-how-would-you-apply-it-to-every-column-of-a-data-frame-how-would-you-apply-it-to-every-numeric-column-in-a-data-frame" class="section level4">
<h4>The function below scales a vector so it falls in the range [0, 1]. How would you apply it to every column of a data frame? How would you apply it to every numeric column in a data frame?</h4>
<p>Since the function only focus on numeric input, so we only let scale01 gets numeric input and return non-numeric input directly with the help of if-else function. And we use lapply function to apply it to every numeric column.</p>
<div class="sourceCode" id="cb100"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a>scale01 <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb100-2"><a href="#cb100-2" aria-hidden="true" tabindex="-1"></a>  rng <span class="ot">&lt;-</span> <span class="fu">range</span>(x, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb100-3"><a href="#cb100-3" aria-hidden="true" tabindex="-1"></a>  (x <span class="sc">-</span> rng[<span class="dv">1</span>]) <span class="sc">/</span> (rng[<span class="dv">2</span>] <span class="sc">-</span> rng[<span class="dv">1</span>])</span>
<span id="cb100-4"><a href="#cb100-4" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb100-5"><a href="#cb100-5" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(cars)</span></code></pre></div>
<pre><code>##   speed dist
## 1     4    2
## 2     4   10
## 3     7    4
## 4     7   22
## 5     8   16
## 6     9   10</code></pre>
<div class="sourceCode" id="cb102"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data.frame</span>(<span class="fu">lapply</span>(cars, <span class="cf">function</span>(x) <span class="cf">if</span> (<span class="fu">is.numeric</span>(x)) <span class="fu">scale01</span>(x) <span class="cf">else</span> x))</span></code></pre></div>
<pre><code>##        speed       dist
## 1  0.0000000 0.00000000
## 2  0.0000000 0.06779661
## 3  0.1428571 0.01694915
## 4  0.1428571 0.16949153
## 5  0.1904762 0.11864407
## 6  0.2380952 0.06779661
## 7  0.2857143 0.13559322
## 8  0.2857143 0.20338983
## 9  0.2857143 0.27118644
## 10 0.3333333 0.12711864
## 11 0.3333333 0.22033898
## 12 0.3809524 0.10169492
## 13 0.3809524 0.15254237
## 14 0.3809524 0.18644068
## 15 0.3809524 0.22033898
## 16 0.4285714 0.20338983
## 17 0.4285714 0.27118644
## 18 0.4285714 0.27118644
## 19 0.4285714 0.37288136
## 20 0.4761905 0.20338983
## 21 0.4761905 0.28813559
## 22 0.4761905 0.49152542
## 23 0.4761905 0.66101695
## 24 0.5238095 0.15254237
## 25 0.5238095 0.20338983
## 26 0.5238095 0.44067797
## 27 0.5714286 0.25423729
## 28 0.5714286 0.32203390
## 29 0.6190476 0.25423729
## 30 0.6190476 0.32203390
## 31 0.6190476 0.40677966
## 32 0.6666667 0.33898305
## 33 0.6666667 0.45762712
## 34 0.6666667 0.62711864
## 35 0.6666667 0.69491525
## 36 0.7142857 0.28813559
## 37 0.7142857 0.37288136
## 38 0.7142857 0.55932203
## 39 0.7619048 0.25423729
## 40 0.7619048 0.38983051
## 41 0.7619048 0.42372881
## 42 0.7619048 0.45762712
## 43 0.7619048 0.52542373
## 44 0.8571429 0.54237288
## 45 0.9047619 0.44067797
## 46 0.9523810 0.57627119
## 47 0.9523810 0.76271186
## 48 0.9523810 0.77118644
## 49 0.9523810 1.00000000
## 50 1.0000000 0.70338983</code></pre>
<div class="sourceCode" id="cb104"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>())</span></code></pre></div>
</div>
</div>
<div id="section-33" class="section level3">
<h3>2</h3>
<div id="use-vapply-to" class="section level4">
<h4>Use vapply() to:</h4>
<div id="a-compute-the-standard-deviation-of-every-column-in-a-numeric-data-frame." class="section level5">
<h5>a) Compute the standard deviation of every column in a numeric data frame.</h5>
<p>We take cars dataset as an example.</p>
<div class="sourceCode" id="cb105"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(cars)</span></code></pre></div>
<pre><code>##   speed dist
## 1     4    2
## 2     4   10
## 3     7    4
## 4     7   22
## 5     8   16
## 6     9   10</code></pre>
<div class="sourceCode" id="cb107"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a><span class="fu">vapply</span>(cars, sd, <span class="fu">numeric</span>(<span class="dv">1</span>))</span></code></pre></div>
<pre><code>##     speed      dist 
##  5.287644 25.769377</code></pre>
<div class="sourceCode" id="cb109"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>())</span></code></pre></div>
</div>
<div id="b-compute-the-standard-deviation-of-every-numeric-column-in-a-mixed-data-frame.-hint-youll-need-to-use-vapply-twice." class="section level5">
<h5>b) Compute the standard deviation of every numeric column in a mixed data frame. (Hint: you’ll need to use vapply() twice.)</h5>
<p>We take iris dataset as an example. vapply() is used twice to figure out whether the column is numeric, since only numeric vector can get standard deviation.</p>
<div class="sourceCode" id="cb110"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(iris)</span></code></pre></div>
<pre><code>##   Sepal.Length Sepal.Width Petal.Length Petal.Width Species
## 1          5.1         3.5          1.4         0.2  setosa
## 2          4.9         3.0          1.4         0.2  setosa
## 3          4.7         3.2          1.3         0.2  setosa
## 4          4.6         3.1          1.5         0.2  setosa
## 5          5.0         3.6          1.4         0.2  setosa
## 6          5.4         3.9          1.7         0.4  setosa</code></pre>
<div class="sourceCode" id="cb112"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a><span class="fu">vapply</span>(iris[<span class="fu">vapply</span>(iris, is.numeric, <span class="fu">logical</span>(<span class="dv">1</span>))],sd, <span class="fu">numeric</span>(<span class="dv">1</span>))</span></code></pre></div>
<pre><code>## Sepal.Length  Sepal.Width Petal.Length  Petal.Width 
##    0.8280661    0.4358663    1.7652982    0.7622377</code></pre>
<div class="sourceCode" id="cb114"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>())</span></code></pre></div>
</div>
</div>
</div>
<div id="section-34" class="section level3">
<h3>3</h3>
<div id="implement-a-gibbs-sampler-to-generate-a-bivariate-normal-chain-x_ty_t-with-zero-means-unit-standard-deviations-and-correlation-0.9." class="section level4">
<h4>Implement a Gibbs sampler to generate a bivariate normal chain <span class="math inline">\((X_t,Y_t)\)</span> with zero means, unit standard deviations, and correlation 0.9.</h4>
<p>There are two kinds of vector in R: atomic and list. The elements in atomic must be same, but the elements in list can be different. If the list contains same kind of elements(integer, character, etc.), as.vector() can work as unlist(). If the list contains several kinds elements, as.vector() will turn it into a list. But unlist() function will turn all the elements into character and output an atomic vector, no matter the elements are the same kind or not.</p>
<div class="sourceCode" id="cb115"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb115-1"><a href="#cb115-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(Rcpp)</span></code></pre></div>
<pre><code>## Warning: package &#39;Rcpp&#39; was built under R version 4.2.2</code></pre>
<div class="sourceCode" id="cb117"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb117-1"><a href="#cb117-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(microbenchmark)</span>
<span id="cb117-2"><a href="#cb117-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-3"><a href="#cb117-3" aria-hidden="true" tabindex="-1"></a>gibbsR <span class="ot">&lt;-</span> <span class="cf">function</span>(m,burn,rho,mu1,mu2,sigma1,sigma2){</span>
<span id="cb117-4"><a href="#cb117-4" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, m, <span class="dv">2</span>)</span>
<span id="cb117-5"><a href="#cb117-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-6"><a href="#cb117-6" aria-hidden="true" tabindex="-1"></a>  s1 <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="dv">1</span><span class="sc">-</span>rho<span class="sc">^</span><span class="dv">2</span>)<span class="sc">*</span>sigma1</span>
<span id="cb117-7"><a href="#cb117-7" aria-hidden="true" tabindex="-1"></a>  s2 <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="dv">1</span><span class="sc">-</span>rho<span class="sc">^</span><span class="dv">2</span>)<span class="sc">*</span>sigma2</span>
<span id="cb117-8"><a href="#cb117-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb117-9"><a href="#cb117-9" aria-hidden="true" tabindex="-1"></a>  mean12 <span class="ot">&lt;-</span> <span class="cf">function</span> (x2) mu1 <span class="sc">+</span> rho<span class="sc">*</span>sigma1<span class="sc">/</span>sigma2<span class="sc">*</span>(x2 <span class="sc">-</span> mu2)</span>
<span id="cb117-10"><a href="#cb117-10" aria-hidden="true" tabindex="-1"></a>  mean21 <span class="ot">&lt;-</span> <span class="cf">function</span> (x1) mu2 <span class="sc">+</span> rho<span class="sc">*</span>sigma2<span class="sc">/</span>sigma1<span class="sc">*</span>(x1 <span class="sc">-</span> mu1)</span>
<span id="cb117-11"><a href="#cb117-11" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb117-12"><a href="#cb117-12" aria-hidden="true" tabindex="-1"></a>  x[<span class="dv">1</span>,] <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)</span>
<span id="cb117-13"><a href="#cb117-13" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb117-14"><a href="#cb117-14" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>m) {</span>
<span id="cb117-15"><a href="#cb117-15" aria-hidden="true" tabindex="-1"></a>    xt <span class="ot">&lt;-</span> x[i<span class="dv">-1</span>,]</span>
<span id="cb117-16"><a href="#cb117-16" aria-hidden="true" tabindex="-1"></a>    xt[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1</span>, <span class="fu">mean12</span>(xt[<span class="dv">2</span>]), s1)</span>
<span id="cb117-17"><a href="#cb117-17" aria-hidden="true" tabindex="-1"></a>    xt[<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1</span>, <span class="fu">mean21</span>(xt[<span class="dv">1</span>]), s2)</span>
<span id="cb117-18"><a href="#cb117-18" aria-hidden="true" tabindex="-1"></a>    x[i,] <span class="ot">&lt;-</span> xt</span>
<span id="cb117-19"><a href="#cb117-19" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb117-20"><a href="#cb117-20" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb117-21"><a href="#cb117-21" aria-hidden="true" tabindex="-1"></a>  b <span class="ot">&lt;-</span> burn <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb117-22"><a href="#cb117-22" aria-hidden="true" tabindex="-1"></a>  x_final <span class="ot">&lt;-</span> x[b<span class="sc">:</span>m,]</span>
<span id="cb117-23"><a href="#cb117-23" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb117-24"><a href="#cb117-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-25"><a href="#cb117-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-26"><a href="#cb117-26" aria-hidden="true" tabindex="-1"></a>data_dir <span class="ot">&lt;-</span> <span class="fu">getwd</span>()</span>
<span id="cb117-27"><a href="#cb117-27" aria-hidden="true" tabindex="-1"></a><span class="co"># sourceCpp(paste0(&quot;./gibbsC.cpp&quot;))</span></span>
<span id="cb117-28"><a href="#cb117-28" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb117-29"><a href="#cb117-29" aria-hidden="true" tabindex="-1"></a>gibbs_R <span class="ot">&lt;-</span> <span class="fu">gibbsR</span>(<span class="dv">10000</span>,<span class="dv">1000</span>,<span class="fl">0.9</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>)</span>
<span id="cb117-30"><a href="#cb117-30" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb117-31"><a href="#cb117-31" aria-hidden="true" tabindex="-1"></a><span class="co"># gibbs_C &lt;- gibbsC(10000,1000,0.9,0,0,1,1)</span></span></code></pre></div>
<div class="sourceCode" id="cb118"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb118-1"><a href="#cb118-1" aria-hidden="true" tabindex="-1"></a><span class="co"># qqplot(gibbs_C,gibbs_R)</span></span></code></pre></div>
<p>From the qq-plot we can see the scatters are on the line of y=x approximately, so we can say that samples generated by c++ and R come from same distribution.</p>
<div class="sourceCode" id="cb119"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb119-1"><a href="#cb119-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ts &lt;- microbenchmark(gibbC=gibbsC(10000,1000,0.9,0,0,1,1),gibbR=gibbsR(10000,1000,0.9,0,0,1,1))</span></span>
<span id="cb119-2"><a href="#cb119-2" aria-hidden="true" tabindex="-1"></a><span class="co"># summary(ts)[,c(1,3,5,6)]</span></span></code></pre></div>
<p>And for from the table we can know that under same algorithm, c++ can compute much faster than R does.</p>
</div>
</div>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
